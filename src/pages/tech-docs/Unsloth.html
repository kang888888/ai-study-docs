<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unsloth è¶…é«˜æ•ˆå¾®è°ƒæ¡†æ¶ - æŠ€æœ¯è¯¦è§£</title>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <!-- å…¬å…±æ ·å¼ -->
    <link rel="stylesheet" href="../common/styles.css">
</head>
<body>
    <div class="container">
        <h1>Unslothï¼šé¢å‘å¼€æºå¤§æ¨¡å‹çš„æè‡´é«˜æ•ˆå¾®è°ƒæ¡†æ¶</h1>
        <p class="tagline">é€šè¿‡å®šåˆ¶åŒ– CUDA Kernelã€Flash Attentionã€è‡ªåŠ¨é‡åŒ–ä¸ LoRA é¢„è®¾ï¼Œå°†è®­ç»ƒé€Ÿåº¦æå‡ 2-5 å€ï¼Œæ˜¾å­˜å ç”¨ä¸‹é™ 80%ã€‚</p>

        <div class="meta-grid">
            <div class="meta-card">
                <h3>æ ¸å¿ƒèƒ½åŠ›</h3>
                <p>å¼€ç®±å³ç”¨çš„ QLoRA+LoRA pipelineã€è‡ªåŠ¨åˆ†å¸ƒå¼å¹¶è¡Œã€å†…å­˜åˆ†æä»ªè¡¨ç›˜ã€‚</p>
            </div>
            <div class="meta-card">
                <h3>æ”¯æŒæ¨¡å‹</h3>
                <p>Llama 3.xã€Mistralã€Mixtralã€Qwenã€Yiã€Phi-3ã€DeepSeek ç­‰ä¸»æµå¼€æº LLMã€‚</p>
            </div>
            <div class="meta-card">
                <h3>éƒ¨ç½²å½¢æ€</h3>
                <p>Colab Notebookã€CLIã€Python APIã€ä¸ Axolotl/Lightning é›†æˆã€‚</p>
            </div>
            <div class="meta-card">
                <h3>é€‚ç”¨åœºæ™¯</h3>
                <p>å¿«é€ŸåŸå‹éªŒè¯ã€ä½æ˜¾å­˜ç¯å¢ƒã€æ•™è‚²è®­ç»ƒè¥ã€è‡ªåŠ¨åŒ– A/B å¾®è°ƒã€‚</p>
            </div>
        </div>

        <div class="section">
            <h2>ğŸš€ æŠ€æœ¯è¦ç‚¹</h2>
            <ul>
                <li><strong>å†…æ ¸çº§ä¼˜åŒ–ï¼š</strong>ä½¿ç”¨è‡ªç ” Flash Attention 2 / xFormers kernelï¼Œå‡å°‘å†…å­˜è¯»å†™ã€‚</li>
                <li><strong>Auto-QLoRAï¼š</strong>è‡ªåŠ¨é€‰æ‹©æœ€é€‚åˆçš„ rankã€target modulesã€é‡åŒ– dtypeã€‚</li>
                <li><strong>å¿«é€Ÿå¯åŠ¨ï¼š</strong>å•æ¡å‘½ä»¤å³å¯ä» Hugging Face Hub ä¸‹è½½æ¨¡å‹ä¸æ•°æ®ã€å¼€å§‹è®­ç»ƒã€‚</li>
                <li><strong>å¯è§†åŒ–ç›‘æ§ï¼š</strong>å†…ç½® Weights & Biasesã€Live Loss Plotã€OOM é¢„è­¦ã€‚</li>
            </ul>
        </div>

        <div class="section">
            <h2>ğŸ“Š å›¾è§£</h2>
            <div class="diagram-gallery">
                <div class="diagram-item">
                    <img src="./assets/Unslothæ¶æ„.png" alt="Unsloth æ¨¡å—åŒ–æ¶æ„" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'">
                    <div class="caption">æ¨¡å—åŒ–æ¶æ„</div>
                </div>
                <div class="diagram-item">
                    <img src="./assets/Unslothæ€§èƒ½.png" alt="æ€§èƒ½åŠ é€Ÿæ•ˆæœ" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'">
                    <div class="caption">æ€§èƒ½åŠ é€Ÿæ•ˆæœ</div>
                </div>
                <div class="diagram-item">
                    <img src="./assets/Unslothå·¥ä½œæµ.png" alt="å·¥ä½œæµ" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'">
                    <div class="caption">å·¥ä½œæµ</div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ“ æ•°å­¦/ç®—æ³•è¦ç‚¹</h2>
            <div class="math-box">
                <h3>æ˜¾å­˜åŠ é€Ÿæ¯”ä¼°ç®—</h3>
                <div class="math-formula">
                    <p>Unsloth é€šè¿‡ 4bit é‡åŒ– + LoRA å°†æ˜¾å­˜é™è‡³ï¼š</p>
                    <p>$$\text{VRAM}_{\text{QLoRA}} \approx \frac{n_{\text{params}} \times 4}{8} + 2 \times n_{\text{LoRA}} \times bytes_{\text{fp16}}$$</p>
                    <p>å…¶ä¸­ $n_{\text{LoRA}} = 2 \cdot d \cdot r$ï¼Œé€šå¸¸ä»…å åŸæ¨¡å‹ 0.5%~1%ã€‚</p>
                </div>
            </div>
            <div class="math-box">
                <h3>ååé‡ä¼°ç®—</h3>
                <div class="math-formula">
                    <p>é…åˆ Flash Attentionï¼Œè®¡ç®—å¤æ‚åº¦è¿‘ä¼¼ï¼š</p>
                    <p>$$\mathcal{O}(n d^2) \rightarrow \mathcal{O}\bigg(\frac{n d^2}{\sqrt{B}}\bigg)$$</p>
                    <p>$B$ ä¸ºå¹¶è¡Œ block æ•°ï¼Œä½“ç°å¤šæµæ‰§è¡Œå¸¦æ¥çš„ååæå‡ã€‚</p>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ’» ä»£ç ç¤ºä¾‹</h2>
            <div class="code-box">
                <h3>Python API ä¸€é”®å¾®è°ƒ</h3>
                <pre><code class="language-python">from unsloth import FastLanguageModel

model, tokenizer = FastLanguageModel.from_pretrained(
    model_name="meta-llama/Llama-3-8b",
    max_seq_length=4096,
    load_in_4bit=True,
)

model = FastLanguageModel.get_peft_model(
    model,
    r=64,
    target_modules=["q_proj", "v_proj", "k_proj", "o_proj"],
    lora_alpha=64,
    lora_dropout=0.05
)

trainer = FastLanguageModel.get_trainer(
    model=model,
    tokenizer=tokenizer,
    dataset="unsloth/guanaco-bilingual",
    logging_steps=10,
    learning_rate=2e-4,
    num_train_epochs=3
)

trainer.train()
</code></pre>
            </div>
        </div>
    </div>

    <div id="imageModal" class="image-modal" onclick="closeImageModal()">
        <span class="image-modal-close" onclick="event.stopPropagation(); closeImageModal();">&times;</span>
        <img id="modalImage" class="image-modal-content" src="" alt="">
        <div id="modalCaption" class="image-modal-caption"></div>
    </div>

    <script>
        function openImageModal(img) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            const modalCaption = document.getElementById('modalCaption');
            modal.classList.add('active');
            modalImg.src = img.src;
            modalCaption.textContent = img.alt || '';
        }
        function closeImageModal() {
            document.getElementById('imageModal').classList.remove('active');
        }
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') closeImageModal();
        });
    </script>
    <!-- å…¬å…±è„šæœ¬ -->
    <script src="../common/tech-document.js"></script>
</body>
</html>
