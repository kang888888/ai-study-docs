<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GRU (Gated Recurrent Unit) é—¨æ§å¾ªç¯å•å…ƒ - æ¶æ„è¯¦è§£</title>
    <!-- MathJax for mathematical formulas -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Prism.js for code highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <!-- å…¬å…±æ ·å¼ -->
    <link rel="stylesheet" href="../common/styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>GRU (Gated Recurrent Unit) é—¨æ§å¾ªç¯å•å…ƒ</h1>
            <p>LSTMçš„ç®€åŒ–ç‰ˆæœ¬ï¼Œæ€§èƒ½ç›¸è¿‘ä½†æ›´é«˜æ•ˆ</p>
        </div>
        <div class="content">
            
            <div class="section">
                <h2>ğŸ“– æ ¸å¿ƒæ¦‚å¿µ</h2>
                <div class="desc-box">
                    <p>LSTMçš„ç®€åŒ–ç‰ˆæœ¬ï¼Œå°†é—å¿˜é—¨å’Œè¾“å…¥é—¨åˆå¹¶ä¸ºæ›´æ–°é—¨ï¼Œå‡å°‘äº†å‚æ•°é‡ã€‚åœ¨å¾ˆå¤šä»»åŠ¡ä¸Šæ€§èƒ½æ¥è¿‘LSTMï¼Œä½†è®­ç»ƒé€Ÿåº¦æ›´å¿«ã€‚</p>
                </div>
            </div>
            <div class="section features">
                <h2>ğŸŒŸ æ ¸å¿ƒç‰¹ç‚¹</h2>
                <ul>
                    <li>ç®€åŒ–ç»“æ„ï¼šåªæœ‰ä¸¤ä¸ªé—¨ï¼ˆé‡ç½®é—¨ã€æ›´æ–°é—¨ï¼‰</li>
                    <li>å‚æ•°æ›´å°‘ï¼šç›¸æ¯”LSTMå‡å°‘çº¦25%å‚æ•°</li>
                    <li>è®¡ç®—æ›´å¿«ï¼šå‰å‘å’Œåå‘ä¼ æ’­é€Ÿåº¦æ›´å¿«</li>
                    <li>æ€§èƒ½ç›¸è¿‘ï¼šåœ¨å¤šæ•°ä»»åŠ¡ä¸Šä¸LSTMæ€§èƒ½ç›¸å½“</li>
                    <li>æ˜“äºè°ƒå‚ï¼šè¶…å‚æ•°æ›´å°‘ï¼Œæ›´å®¹æ˜“è°ƒä¼˜</li>
                </ul>
            </div>
            <div class="section">
                <h2>âš™ï¸ å…³é”®æŠ€æœ¯</h2>
                <div class="tech-box"><p><strong>æ›´æ–°é—¨ã€é‡ç½®é—¨ã€å€™é€‰éšè—çŠ¶æ€</strong></p></div>
            </div>
            <div class="section">
                <h2>ğŸš€ åº”ç”¨åœºæ™¯</h2>
                <div class="app-box"><p>åºåˆ—å»ºæ¨¡ã€æ—¶é—´åºåˆ—é¢„æµ‹ã€NLPä»»åŠ¡ã€è¯­éŸ³è¯†åˆ«</p></div>
            </div>
            <div class="section">
                <h2>ğŸ“Š æ¶æ„å›¾è§£</h2>
                <div class="diagram-gallery">
                    <div class="diagram-item"><img src="GRUå•å…ƒç»“æ„.png" alt="GRUå•å…ƒç»“æ„" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'"><div class="caption">GRUå•å…ƒç»“æ„</div></div>
                    <div class="diagram-item"><img src="GRUåºåˆ—å±•å¼€.png" alt="GRUåºåˆ—å±•å¼€" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'"><div class="caption">GRUåºåˆ—å±•å¼€</div></div>
                    <div class="diagram-item"><img src="GRU_vs_LSTMå¯¹æ¯”.png" alt="GRU vs LSTMå¯¹æ¯”" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'"><div class="caption">GRU vs LSTMå¯¹æ¯”</div></div>
                </div>
            </div>

            <div class="section">
                <h2>ğŸ“ æ•°å­¦åŸç†</h2>
                <div class="math-box">
                    <h3>GRU æ ¸å¿ƒå…¬å¼</h3>
                    <div class="math-formula">
                        <p>åœ¨æ—¶é—´æ­¥ $t$ï¼ŒGRU çš„è®¡ç®—è¿‡ç¨‹ï¼š</p>
                        <p><strong>é‡ç½®é—¨ï¼ˆReset Gateï¼‰ï¼š</strong></p>
                        <p>$$r_t = \sigma(W_r \cdot [h_{t-1}, x_t])$$</p>
                        <p><strong>æ›´æ–°é—¨ï¼ˆUpdate Gateï¼‰ï¼š</strong></p>
                        <p>$$z_t = \sigma(W_z \cdot [h_{t-1}, x_t])$$</p>
                        <p><strong>å€™é€‰éšè—çŠ¶æ€ï¼š</strong></p>
                        <p>$$\tilde{h}_t = \tanh(W \cdot [r_t * h_{t-1}, x_t])$$</p>
                        <p><strong>éšè—çŠ¶æ€æ›´æ–°ï¼š</strong></p>
                        <p>$$h_t = (1 - z_t) * h_{t-1} + z_t * \tilde{h}_t$$</p>
                        <p>å…¶ä¸­ $*$ è¡¨ç¤ºé€å…ƒç´ ç›¸ä¹˜ï¼Œ$\sigma$ æ˜¯ sigmoid å‡½æ•°</p>
                    </div>
                </div>
                <div class="math-box">
                    <h3>ä¸ LSTM çš„åŒºåˆ«</h3>
                    <div class="math-formula">
                        <p>GRU å°† LSTM çš„é—å¿˜é—¨å’Œè¾“å…¥é—¨åˆå¹¶ä¸ºæ›´æ–°é—¨ï¼š</p>
                        <p>$$z_t = \sigma(W_z \cdot [h_{t-1}, x_t])$$</p>
                        <p>æ›´æ–°é—¨ $z_t$ åŒæ—¶æ§åˆ¶é—å¿˜å’Œè¾“å…¥ï¼š</p>
                        <ul style="list-style: none; padding-left: 20px;">
                            <li>$z_t \approx 0$ï¼šä¿ç•™æ—§çŠ¶æ€ï¼ˆç±»ä¼¼é—å¿˜é—¨ï¼‰</li>
                            <li>$z_t \approx 1$ï¼šä½¿ç”¨æ–°çŠ¶æ€ï¼ˆç±»ä¼¼è¾“å…¥é—¨ï¼‰</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>ğŸ’» Python ä»£ç ç¤ºä¾‹</h2>
                <div class="code-box">
                    <h3>ä½¿ç”¨ PyTorch å®ç° GRU</h3>
                    <pre><code class="language-python">import torch
import torch.nn as nn

class GRUCell(nn.Module):
    """æ‰‹åŠ¨å®ç° GRU å•å…ƒ"""
    def __init__(self, input_size, hidden_size):
        super(GRUCell, self).__init__()
        self.hidden_size = hidden_size
        
        # é‡ç½®é—¨
        self.W_r = nn.Linear(input_size + hidden_size, hidden_size)
        
        # æ›´æ–°é—¨
        self.W_z = nn.Linear(input_size + hidden_size, hidden_size)
        
        # å€™é€‰éšè—çŠ¶æ€
        self.W_h = nn.Linear(input_size + hidden_size, hidden_size)
    
    def forward(self, x, h_prev):
        """
        å‰å‘ä¼ æ’­
        
        å‚æ•°:
            x: å½“å‰è¾“å…¥ (batch_size, input_size)
            h_prev: å‰ä¸€ä¸ªéšè—çŠ¶æ€ (batch_size, hidden_size)
        """
        # æ‹¼æ¥è¾“å…¥å’Œéšè—çŠ¶æ€
        combined = torch.cat([x, h_prev], dim=1)
        
        # é‡ç½®é—¨
        r_t = torch.sigmoid(self.W_r(combined))
        
        # æ›´æ–°é—¨
        z_t = torch.sigmoid(self.W_z(combined))
        
        # å€™é€‰éšè—çŠ¶æ€
        combined_reset = torch.cat([x, r_t * h_prev], dim=1)
        h_tilde = torch.tanh(self.W_h(combined_reset))
        
        # æ›´æ–°éšè—çŠ¶æ€
        h_t = (1 - z_t) * h_prev + z_t * h_tilde
        
        return h_t

class GRU_Model(nn.Module):
    """ä½¿ç”¨ PyTorch å†…ç½® GRU"""
    def __init__(self, input_size, hidden_size, num_layers, num_classes):
        super(GRU_Model, self).__init__()
        self.hidden_size = hidden_size
        self.num_layers = num_layers
        
        # GRU å±‚
        self.gru = nn.GRU(input_size, hidden_size, num_layers,
                         batch_first=True, dropout=0.2)
        
        # å…¨è¿æ¥å±‚
        self.fc = nn.Linear(hidden_size, num_classes)
    
    def forward(self, x):
        # x shape: (batch_size, seq_length, input_size)
        # åˆå§‹åŒ–éšè—çŠ¶æ€
        h0 = torch.zeros(self.num_layers, x.size(0), self.hidden_size).to(x.device)
        
        # GRU å‰å‘ä¼ æ’­
        out, h_n = self.gru(x, h0)
        
        # ä½¿ç”¨æœ€åä¸€ä¸ªæ—¶é—´æ­¥çš„è¾“å‡º
        out = self.fc(out[:, -1, :])
        
        return out

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # ä½¿ç”¨ PyTorch å†…ç½® GRU
    model = GRU_Model(input_size=128, hidden_size=256, 
                     num_layers=2, num_classes=10)
    
    # æ¨¡æ‹Ÿè¾“å…¥ (batch_size=32, seq_length=50, input_size=128)
    x = torch.randn(32, 50, 128)
    
    # å‰å‘ä¼ æ’­
    output = model(x)
    print(f"è¾“å‡ºå½¢çŠ¶: {output.shape}")  # [32, 10]
    
    # æ‰‹åŠ¨å®ç° GRU Cell
    gru_cell = GRUCell(input_size=128, hidden_size=256)
    
    # åˆå§‹åŒ–çŠ¶æ€
    h = torch.zeros(32, 256)
    
    # å¤„ç†åºåˆ—
    for t in range(50):
        x_t = torch.randn(32, 128)
        h = gru_cell(x_t, h)
    
    print(f"æœ€ç»ˆéšè—çŠ¶æ€å½¢çŠ¶: {h.shape}")</code></pre>
                </div>
            </div>
        </div>
    </div>
    <!-- å›¾ç‰‡æ”¾å¤§å¼¹çª— -->
    <div id="imageModal" class="image-modal" onclick="closeImageModal()">
        <span class="image-modal-close" onclick="event.stopPropagation(); closeImageModal()">&times;</span>
        <img id="modalImage" class="image-modal-content" src="" alt="">
        <div id="modalCaption" class="image-modal-caption"></div>
    </div>
    <script>
        function openImageModal(img) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            const modalCaption = document.getElementById('modalCaption');
            modal.classList.add('active');
            modalImg.src = img.src;
            modalCaption.textContent = img.alt || '';
            modalImg.onclick = function(e) { e.stopPropagation(); };
        }
        function closeImageModal() {
            document.getElementById('imageModal').classList.remove('active');
        }
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') closeImageModal();
        });
    </script>
    <!-- å…¬å…±è„šæœ¬ -->
    <script src="../common/tech-document.js"></script>
</body>
</html>

