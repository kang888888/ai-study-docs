<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAN (Generative Adversarial Network) ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ - æ¶æ„è¯¦è§£</title>
    <!-- MathJax for mathematical formulas -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Prism.js for code highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <!-- å…¬å…±æ ·å¼ -->
    <link rel="stylesheet" href="../common/styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>GAN (Generative Adversarial Network) ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ</h1>
            <p>ç”Ÿæˆå™¨ä¸åˆ¤åˆ«å™¨çš„å¯¹æŠ—åšå¼ˆ</p>
        </div>
        <div class="content">
            
            
            <div class="section">
                <h2>ğŸ“– æ ¸å¿ƒæ¦‚å¿µ</h2>
                <div class="desc-box">
                    <p>ç”±ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰å’Œåˆ¤åˆ«å™¨ï¼ˆDiscriminatorï¼‰ç»„æˆçš„å¯¹æŠ—ç³»ç»Ÿã€‚ç”Ÿæˆå™¨è¯•å›¾ç”Ÿæˆé€¼çœŸæ•°æ®ï¼Œåˆ¤åˆ«å™¨è¯•å›¾åŒºåˆ†çœŸå‡ï¼Œä¸¤è€…åšå¼ˆæœ€ç»ˆè¾¾åˆ°çº³ä»€å‡è¡¡ã€‚</p>
                </div>
            </div>

            <div class="section features">
                <h2>ğŸŒŸ æ ¸å¿ƒç‰¹ç‚¹</h2>
                <ul>
                    <li>å¯¹æŠ—è®­ç»ƒï¼šç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨ç›¸äº’åšå¼ˆï¼Œäº¤æ›¿è®­ç»ƒ</li>
                    <li>ç”Ÿæˆé€Ÿåº¦å¿«ï¼šä¸€æ¬¡å‰å‘ä¼ æ’­å³å¯ç”Ÿæˆï¼Œæ— éœ€å¤šæ­¥é‡‡æ ·</li>
                    <li>è®­ç»ƒä¸ç¨³å®šï¼šå®¹æ˜“å‡ºç°æ¨¡å¼å´©æºƒï¼ˆMode Collapseï¼‰</li>
                    <li>æ— æ˜¾å¼å¯†åº¦ï¼šä¸å­¦ä¹ æ•°æ®åˆ†å¸ƒçš„æ˜¾å¼å½¢å¼</li>
                    <li>å¤šç§å˜ä½“ï¼šDCGANã€StyleGANã€CycleGANç­‰</li>
                </ul>
            </div>

            <div class="section">
                <h2>âš™ï¸ å…³é”®æŠ€æœ¯</h2>
                <div class="tech-box">
                    <p><strong>å¯¹æŠ—æŸå¤±ã€WGANã€è°±å½’ä¸€åŒ–ï¼ˆSpectral Normalizationï¼‰ã€æ¸è¿›å¼è®­ç»ƒ</strong></p>
                </div>
            </div>

            <div class="section">
                <h2>ğŸš€ åº”ç”¨åœºæ™¯</h2>
                <div class="app-box">
                    <p>å›¾åƒç”Ÿæˆã€é£æ ¼è¿ç§»ã€å›¾åƒè¶…åˆ†è¾¨ç‡ã€æ•°æ®å¢å¼ºã€äººè„¸ç”Ÿæˆï¼ˆStyleGANï¼‰</p>
                </div>
            </div>

            <div class="section">
                <h2>ğŸ“Š æ¶æ„å›¾è§£</h2>
                <div class="diagram-gallery">
                    <div class="diagram-item">
                        <img src="GANæ¶æ„å›¾.png" alt="GANæ¶æ„å›¾" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'">
                        <div class="caption">GANæ¶æ„å›¾</div>
                    </div>
                    <div class="diagram-item">
                        <img src="GANè®­ç»ƒè¿‡ç¨‹.png" alt="GANè®­ç»ƒè¿‡ç¨‹" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'">
                        <div class="caption">GANè®­ç»ƒè¿‡ç¨‹</div>
                    </div>
                    <div class="diagram-item">
                        <img src="GANåˆ†å¸ƒæ¼”åŒ–.png" alt="GANåˆ†å¸ƒæ¼”åŒ–" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'">
                        <div class="caption">GANåˆ†å¸ƒæ¼”åŒ–</div>
                    </div>
                    <div class="diagram-item">
                        <img src="GANå˜ä½“å¯¹æ¯”.png" alt="GANå˜ä½“å¯¹æ¯”" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'">
                        <div class="caption">GANå˜ä½“å¯¹æ¯”</div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>ğŸ“ æ•°å­¦åŸç†</h2>
                <div class="math-box">
                    <h3>GAN çš„å¯¹æŠ—æŸå¤±å‡½æ•°</h3>
                    <div class="math-formula">
                        <p>GAN çš„ä¼˜åŒ–ç›®æ ‡æ˜¯ä¸€ä¸ªæå°æå¤§åšå¼ˆï¼š</p>
                        <p>$$\min_G \max_D V(D, G) = \mathbb{E}_{x \sim p_{data}(x)}[\log D(x)] + \mathbb{E}_{z \sim p_z(z)}[\log(1 - D(G(z)))]$$</p>
                        <p>å…¶ä¸­ï¼š</p>
                        <ul style="list-style: none; padding-left: 20px;">
                            <li>$G$ æ˜¯ç”Ÿæˆå™¨ï¼Œ$D$ æ˜¯åˆ¤åˆ«å™¨</li>
                            <li>$p_{data}(x)$ æ˜¯çœŸå®æ•°æ®åˆ†å¸ƒ</li>
                            <li>$p_z(z)$ æ˜¯å™ªå£°åˆ†å¸ƒï¼ˆé€šå¸¸æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼‰</li>
                            <li>ç”Ÿæˆå™¨è¯•å›¾æœ€å°åŒ–ï¼Œåˆ¤åˆ«å™¨è¯•å›¾æœ€å¤§åŒ–</li>
                        </ul>
                    </div>
                </div>
                <div class="math-box">
                    <h3>æœ€ä¼˜åˆ¤åˆ«å™¨</h3>
                    <div class="math-formula">
                        <p>å¯¹äºå›ºå®šçš„ç”Ÿæˆå™¨ $G$ï¼Œæœ€ä¼˜åˆ¤åˆ«å™¨ä¸ºï¼š</p>
                        <p>$$D^*(x) = \frac{p_{data}(x)}{p_{data}(x) + p_g(x)}$$</p>
                        <p>å…¶ä¸­ $p_g(x)$ æ˜¯ç”Ÿæˆå™¨ç”Ÿæˆçš„æ•°æ®åˆ†å¸ƒ</p>
                    </div>
                </div>
                <div class="math-box">
                    <h3>å…¨å±€æœ€ä¼˜è§£</h3>
                    <div class="math-formula">
                        <p>å½“ $p_g = p_{data}$ æ—¶è¾¾åˆ°å…¨å±€æœ€ä¼˜ï¼Œæ­¤æ—¶ï¼š</p>
                        <p>$$D^*(x) = \frac{1}{2}$$</p>
                        <p>åˆ¤åˆ«å™¨æ— æ³•åŒºåˆ†çœŸå®æ•°æ®å’Œç”Ÿæˆæ•°æ®</p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>ğŸ’» Python ä»£ç ç¤ºä¾‹</h2>
                <div class="code-box">
                    <h3>ä½¿ç”¨ PyTorch å®ç°ç®€å• GAN</h3>
                    <pre><code class="language-python">import torch
import torch.nn as nn
import torch.optim as optim
import torch.nn.functional as F

class Generator(nn.Module):
    """ç”Ÿæˆå™¨ç½‘ç»œ"""
    def __init__(self, latent_dim, img_shape):
        super(Generator, self).__init__()
        self.img_shape = img_shape
        
        def block(in_feat, out_feat, normalize=True):
            layers = [nn.Linear(in_feat, out_feat)]
            if normalize:
                layers.append(nn.BatchNorm1d(out_feat, 0.8))
            layers.append(nn.LeakyReLU(0.2, inplace=True))
            return layers
        
        self.model = nn.Sequential(
            *block(latent_dim, 128, normalize=False),
            *block(128, 256),
            *block(256, 512),
            *block(512, 1024),
            nn.Linear(1024, int(torch.prod(torch.tensor(img_shape)))),
            nn.Tanh()
        )
    
    def forward(self, z):
        img = self.model(z)
        img = img.view(img.size(0), *self.img_shape)
        return img

class Discriminator(nn.Module):
    """åˆ¤åˆ«å™¨ç½‘ç»œ"""
    def __init__(self, img_shape):
        super(Discriminator, self).__init__()
        
        self.model = nn.Sequential(
            nn.Linear(int(torch.prod(torch.tensor(img_shape))), 512),
            nn.LeakyReLU(0.2, inplace=True),
            nn.Linear(512, 256),
            nn.LeakyReLU(0.2, inplace=True),
            nn.Linear(256, 1),
            nn.Sigmoid()
        )
    
    def forward(self, img):
        img_flat = img.view(img.size(0), -1)
        validity = self.model(img_flat)
        return validity

# è®­ç»ƒå‡½æ•°
def train_gan(generator, discriminator, dataloader, epochs=200, lr=0.0002, latent_dim=100):
    device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
    
    generator = generator.to(device)
    discriminator = discriminator.to(device)
    
    optimizer_G = optim.Adam(generator.parameters(), lr=lr, betas=(0.5, 0.999))
    optimizer_D = optim.Adam(discriminator.parameters(), lr=lr, betas=(0.5, 0.999))
    
    adversarial_loss = nn.BCELoss()
    
    for epoch in range(epochs):
        for i, (imgs, _) in enumerate(dataloader):
            batch_size = imgs.size(0)
            real_imgs = imgs.to(device)
            
            # è®­ç»ƒåˆ¤åˆ«å™¨
            optimizer_D.zero_grad()
            
            # çœŸå®æ•°æ®
            real_validity = discriminator(real_imgs)
            real_loss = adversarial_loss(real_validity, torch.ones(batch_size, 1).to(device))
            
            # ç”Ÿæˆæ•°æ®
            z = torch.randn(batch_size, latent_dim).to(device)
            fake_imgs = generator(z)
            fake_validity = discriminator(fake_imgs.detach())
            fake_loss = adversarial_loss(fake_validity, torch.zeros(batch_size, 1).to(device))
            
            d_loss = (real_loss + fake_loss) / 2
            d_loss.backward()
            optimizer_D.step()
            
            # è®­ç»ƒç”Ÿæˆå™¨
            optimizer_G.zero_grad()
            
            z = torch.randn(batch_size, latent_dim).to(device)
            gen_imgs = generator(z)
            validity = discriminator(gen_imgs)
            g_loss = adversarial_loss(validity, torch.ones(batch_size, 1).to(device))
            
            g_loss.backward()
            optimizer_G.step()
            
            if i % 100 == 0:
                print(f"[Epoch {epoch}/{epochs}] [Batch {i}] [D loss: {d_loss.item():.4f}] [G loss: {g_loss.item():.4f}]")

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    img_shape = (1, 28, 28)  # MNISTå›¾åƒå½¢çŠ¶
    latent_dim = 100
    
    generator = Generator(latent_dim, img_shape)
    discriminator = Discriminator(img_shape)
    
    print(f"ç”Ÿæˆå™¨å‚æ•°é‡: {sum(p.numel() for p in generator.parameters()):,}")
    print(f"åˆ¤åˆ«å™¨å‚æ•°é‡: {sum(p.numel() for p in discriminator.parameters()):,}")</code></pre>
                </div>
            </div>
        </div>
    </div>
    <!-- å›¾ç‰‡æ”¾å¤§å¼¹çª— -->
    <div id="imageModal" class="image-modal" onclick="closeImageModal()">
        <span class="image-modal-close" onclick="event.stopPropagation(); closeImageModal()">&times;</span>
        <img id="modalImage" class="image-modal-content" src="" alt="">
        <div id="modalCaption" class="image-modal-caption"></div>
    </div>
    <script>
        function openImageModal(img) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            const modalCaption = document.getElementById('modalCaption');
            modal.classList.add('active');
            modalImg.src = img.src;
            modalCaption.textContent = img.alt || '';
            modalImg.onclick = function(e) { e.stopPropagation(); };
        }
        function closeImageModal() {
            document.getElementById('imageModal').classList.remove('active');
        }
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') closeImageModal();
        });
    </script>
    <!-- å…¬å…±è„šæœ¬ -->
    <script src="../common/tech-document.js"></script>
</body>
</html>

