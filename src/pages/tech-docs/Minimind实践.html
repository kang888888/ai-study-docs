<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimindå®è·µ</title>
    <script>
        window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']] }, options: { skipHtmlTags: ['script','noscript','style','textarea','pre','code'] } };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <!-- å…¬å…±æ ·å¼ -->
    <link rel="stylesheet" href="../common/styles.css">
</head>
<body>
    <div class="container">
        <h1>Minimindï¼šä»é›¶è®­ç»ƒGPTå®è·µ</h1>
        <p class="tagline">åœ¨2å°æ—¶å†…ä»é›¶å¼€å§‹è®­ç»ƒä¸€ä¸ª2600ä¸‡å‚æ•°çš„å°å‹GPTæ¨¡å‹ã€‚</p>

        <div class="meta-grid">
            <div class="meta-card"><h3>é¡¹ç›®ç‰¹ç‚¹</h3><p>å®Œæ•´çš„è®­ç»ƒæµç¨‹ã€æ•™å­¦å‹å¥½ã€èµ„æºéœ€æ±‚ä½ã€‚</p></div>
            <div class="meta-card"><h3>æ¨¡å‹è§„æ¨¡</h3><p>2600ä¸‡å‚æ•°ï¼Œå•å¡è®­ç»ƒï¼Œ2å°æ—¶å®Œæˆã€‚</p></div>
            <div class="meta-card"><h3>æ ¸å¿ƒå†…å®¹</h3><p>æ•°æ®å‡†å¤‡ã€æ¨¡å‹å®ç°ã€è®­ç»ƒè¿‡ç¨‹ã€è¯„ä¼°éªŒè¯ã€‚</p></div>
            <div class="meta-card"><h3>å­¦ä¹ ä»·å€¼</h3><p>ç†è§£GPTå®Œæ•´è®­ç»ƒæµç¨‹ã€‚</p></div>
        </div>

        <div class="section">
            <h2>âš™ï¸ é¡¹ç›®æ¦‚è¿°</h2>
            <ul>
                <li><strong>GitHubä»“åº“</strong>ï¼šhttps://github.com/jingyaogong/minimind</li>
                <li><strong>æ¨¡å‹è§„æ¨¡</strong>ï¼š2600ä¸‡å‚æ•°ï¼ˆ26Mï¼‰</li>
                <li><strong>è®­ç»ƒæ—¶é—´</strong>ï¼šçº¦2å°æ—¶</li>
                <li><strong>ç›®æ ‡</strong>ï¼šæ•™å­¦å’Œå®è·µGPTæ¨¡å‹è®­ç»ƒ</li>
            </ul>
        </div>

        <div class="section">
            <h2>ğŸ”§ æ ¸å¿ƒå†…å®¹</h2>
            
            <h3 style="color:#fbbf24; margin-top:20px;">1. æ¨¡å‹æ¶æ„</h3>
            <ul>
                <li><strong>GPTæ¶æ„</strong>ï¼šåŸºäºTransformerçš„è§£ç å™¨æ¶æ„</li>
                <li><strong>æ¨¡å‹é…ç½®</strong>ï¼š6-12å±‚ï¼Œéšè—ç»´åº¦512-768ï¼Œæ³¨æ„åŠ›å¤´æ•°8-12</li>
                <li><strong>ä¸Šä¸‹æ–‡é•¿åº¦</strong>ï¼š512-1024 tokens</li>
            </ul>

            <h3 style="color:#fbbf24; margin-top:20px;">2. è®­ç»ƒæµç¨‹</h3>
            <ul>
                <li><strong>æ•°æ®å‡†å¤‡</strong>ï¼šä»åŸå§‹æ–‡æœ¬åˆ°è®­ç»ƒæ•°æ®ï¼ŒTokenization</li>
                <li><strong>æ¨¡å‹å®ç°</strong>ï¼šEmbeddingå±‚ã€Transformer Blockã€è¾“å‡ºå±‚</li>
                <li><strong>è®­ç»ƒè¿‡ç¨‹</strong>ï¼šå®Œæ•´çš„è®­ç»ƒå¾ªç¯ï¼ŒæŸå¤±å‡½æ•°ï¼Œä¼˜åŒ–å™¨</li>
                <li><strong>è¯„ä¼°éªŒè¯</strong>ï¼šæ¨¡å‹æ€§èƒ½è¯„ä¼°ï¼Œç”Ÿæˆè´¨é‡æ£€æŸ¥</li>
            </ul>
        </div>

        <div class="section">
            <h2>ğŸ’» ä»£ç ç¤ºä¾‹</h2>
            <div class="code-box">
                <h3>GPTæ¨¡å‹å®ç°ç¤ºä¾‹</h3>
                <pre><code class="language-python">class GPTModel(nn.Module):
    def __init__(self, vocab_size, n_layer, n_head, n_embd):
        # åµŒå…¥å±‚
        self.token_embedding = nn.Embedding(vocab_size, n_embd)
        self.position_embedding = nn.Embedding(block_size, n_embd)
        
        # Transformerå—
        self.blocks = nn.ModuleList([
            TransformerBlock(n_embd, n_head) 
            for _ in range(n_layer)
        ])
        
        # è¾“å‡ºå±‚
        self.lm_head = nn.Linear(n_embd, vocab_size)
    
    def forward(self, idx):
        # å‰å‘ä¼ æ’­
        B, T = idx.shape
        tok_emb = self.token_embedding(idx)
        pos_emb = self.position_embedding(torch.arange(T))
        x = tok_emb + pos_emb
        
        for block in self.blocks:
            x = block(x)
        
        logits = self.lm_head(x)
        return logits</code></pre>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ“Š è®­ç»ƒè¦ç‚¹</h2>
            <ul>
                <li><strong>æ··åˆç²¾åº¦è®­ç»ƒ</strong>ï¼šä½¿ç”¨FP16/BF16åŠ é€Ÿè®­ç»ƒ</li>
                <li><strong>æ¢¯åº¦ç´¯ç§¯</strong>ï¼šæ¨¡æ‹Ÿæ›´å¤§çš„æ‰¹æ¬¡å¤§å°</li>
                <li><strong>å­¦ä¹ ç‡è°ƒåº¦</strong>ï¼šä½¿ç”¨warmupå’Œcosine decay</li>
                <li><strong>æ£€æŸ¥ç‚¹ä¿å­˜</strong>ï¼šå®šæœŸä¿å­˜æ¨¡å‹æ£€æŸ¥ç‚¹</li>
            </ul>
        </div>
    </div>
    <!-- å…¬å…±è„šæœ¬ -->
    <script src="../common/tech-document.js"></script>
</body>
</html>

