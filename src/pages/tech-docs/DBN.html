<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DBN (Deep Belief Network) æ·±åº¦ä¿¡å¿µç½‘ç»œ - æ¶æ„è¯¦è§£</title>
    <!-- MathJax for mathematical formulas -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Prism.js for code highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <!-- å…¬å…±æ ·å¼ -->
    <link rel="stylesheet" href="../common/styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>DBN (Deep Belief Network) æ·±åº¦ä¿¡å¿µç½‘ç»œ</h1>
            <p>æ·±åº¦å­¦ä¹ æ—©æœŸçš„é‡è¦æ¶æ„</p>
        </div>
        <div class="content">
            
            <div class="section">
                <h2>ğŸ“– æ ¸å¿ƒæ¦‚å¿µ</h2>
                <div class="desc-box">
                    <p>ç”±å¤šä¸ªå—é™ç»å°”å…¹æ›¼æœºï¼ˆRBMï¼‰å †å è€Œæˆçš„æ·±åº¦ç”Ÿæˆæ¨¡å‹ã€‚é€šè¿‡é€å±‚é¢„è®­ç»ƒ+å¾®è°ƒçš„æ–¹å¼è®­ç»ƒï¼Œæ˜¯æ·±åº¦å­¦ä¹ æ—©æœŸï¼ˆ2006å¹´ï¼‰çš„é‡è¦æ¶æ„ã€‚</p>
                </div>
            </div>
            <div class="section features">
                <h2>ğŸŒŸ æ ¸å¿ƒç‰¹ç‚¹</h2>
                <ul>
                    <li>é€å±‚é¢„è®­ç»ƒï¼šå…ˆæ— ç›‘ç£é¢„è®­ç»ƒæ¯å±‚RBMï¼Œå†æœ‰ç›‘ç£å¾®è°ƒ</li>
                    <li>ç”Ÿæˆæ¨¡å‹ï¼šå¯ä»¥ç”Ÿæˆæ•°æ®ï¼Œä¹Ÿå¯ä»¥ç”¨äºåˆ†ç±»</li>
                    <li>æ— ç›‘ç£å­¦ä¹ ï¼šä»æ— æ ‡æ³¨æ•°æ®ä¸­å­¦ä¹ ç‰¹å¾</li>
                    <li>å†å²æ„ä¹‰ï¼š2006å¹´æ·±åº¦å­¦ä¹ å¤å…´çš„å…³é”®æŠ€æœ¯</li>
                    <li>ç°å·²è¾ƒå°‘ä½¿ç”¨ï¼šè¢«Transformerç­‰æ¶æ„å–ä»£</li>
                </ul>
            </div>
            <div class="section">
                <h2>âš™ï¸ å…³é”®æŠ€æœ¯</h2>
                <div class="tech-box"><p><strong>å—é™ç»å°”å…¹æ›¼æœºï¼ˆRBMï¼‰ã€å¯¹æ¯”æ•£åº¦ç®—æ³•ï¼ˆContrastive Divergenceï¼‰ã€é€å±‚é¢„è®­ç»ƒ</strong></p></div>
            </div>
            <div class="section">
                <h2>ğŸš€ åº”ç”¨åœºæ™¯</h2>
                <div class="app-box"><p>å›¾åƒè¯†åˆ«ã€ç‰¹å¾æå–ã€é™ç»´ã€ååŒè¿‡æ»¤ï¼ˆæ—©æœŸï¼‰</p></div>
            </div>
            <div class="section">
                <h2>ğŸ“Š æ¶æ„å›¾è§£</h2>
                <div class="diagram-gallery">
                    <div class="diagram-item"><img src="DBNæ¶æ„.png" alt="DBNæ¶æ„" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'"><div class="caption">DBNæ¶æ„</div></div>
                    <div class="diagram-item"><img src="RBMç»“æ„.png" alt="RBMç»“æ„" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'"><div class="caption">RBMç»“æ„</div></div>
                </div>
            </div>

            <div class="section">
                <h2>ğŸ“ æ•°å­¦åŸç†</h2>
                <div class="math-box">
                    <h3>å—é™ç»å°”å…¹æ›¼æœºï¼ˆRBMï¼‰èƒ½é‡å‡½æ•°</h3>
                    <div class="math-formula">
                        <p>RBMçš„èƒ½é‡å‡½æ•°ï¼š</p>
                        <p>$$E(v, h) = -\sum_{i} a_i v_i - \sum_{j} b_j h_j - \sum_{i,j} v_i W_{ij} h_j$$</p>
                        <p>å…¶ä¸­ï¼š</p>
                        <ul style="list-style: none; padding-left: 20px;">
                            <li>$v$ æ˜¯å¯è§å±‚ï¼ˆè¾“å…¥ï¼‰</li>
                            <li>$h$ æ˜¯éšè—å±‚</li>
                            <li>$W$ æ˜¯æƒé‡çŸ©é˜µ</li>
                            <li>$a, b$ æ˜¯åç½®</li>
                        </ul>
                    </div>
                </div>
                <div class="math-box">
                    <h3>æ¦‚ç‡åˆ†å¸ƒ</h3>
                    <div class="math-formula">
                        <p>åŸºäºèƒ½é‡å‡½æ•°çš„æ¦‚ç‡åˆ†å¸ƒï¼š</p>
                        <p>$$P(v, h) = \frac{1}{Z} e^{-E(v, h)}$$</p>
                        <p>å…¶ä¸­ $Z = \sum_{v,h} e^{-E(v, h)}$ æ˜¯é…åˆ†å‡½æ•°</p>
                        <p>æ¡ä»¶æ¦‚ç‡ï¼š</p>
                        <p>$$P(h_j=1 | v) = \sigma(b_j + \sum_{i} W_{ij} v_i)$$</p>
                        <p>$$P(v_i=1 | h) = \sigma(a_i + \sum_{j} W_{ij} h_j)$$</p>
                    </div>
                </div>
                <div class="math-box">
                    <h3>å¯¹æ¯”æ•£åº¦ï¼ˆCDï¼‰ç®—æ³•</h3>
                    <div class="math-formula">
                        <p>æƒé‡æ›´æ–°è§„åˆ™ï¼š</p>
                        <p>$$\Delta W_{ij} = \epsilon (\langle v_i h_j \rangle_{data} - \langle v_i h_j \rangle_{recon})$$</p>
                        <p>å…¶ä¸­ $\langle \cdot \rangle_{data}$ æ˜¯æ•°æ®åˆ†å¸ƒçš„æœŸæœ›ï¼Œ$\langle \cdot \rangle_{recon}$ æ˜¯é‡æ„åˆ†å¸ƒçš„æœŸæœ›</p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>ğŸ’» Python ä»£ç ç¤ºä¾‹</h2>
                <div class="code-box">
                    <h3>ä½¿ç”¨ PyTorch å®ç°ç®€å•çš„ RBM</h3>
                    <pre><code class="language-python">import torch
import torch.nn as nn
import torch.nn.functional as F

class RBM(nn.Module):
    """å—é™ç»å°”å…¹æ›¼æœº"""
    def __init__(self, n_visible, n_hidden):
        super(RBM, self).__init__()
        self.n_visible = n_visible
        self.n_hidden = n_hidden
        
        # æƒé‡å’Œåç½®
        self.W = nn.Parameter(torch.randn(n_visible, n_hidden) * 0.1)
        self.v_bias = nn.Parameter(torch.zeros(n_visible))
        self.h_bias = nn.Parameter(torch.zeros(n_hidden))
    
    def sample_h(self, v):
        """ç»™å®šå¯è§å±‚ï¼Œé‡‡æ ·éšè—å±‚"""
        p_h = torch.sigmoid(torch.matmul(v, self.W) + self.h_bias)
        return p_h, torch.bernoulli(p_h)
    
    def sample_v(self, h):
        """ç»™å®šéšè—å±‚ï¼Œé‡‡æ ·å¯è§å±‚"""
        p_v = torch.sigmoid(torch.matmul(h, self.W.t()) + self.v_bias)
        return p_v, torch.bernoulli(p_v)
    
    def contrastive_divergence(self, v0, k=1):
        """å¯¹æ¯”æ•£åº¦ç®—æ³•"""
        # æ­£ç›¸
        p_h0, h0 = self.sample_h(v0)
        
        # è´Ÿç›¸ï¼ˆGibbsé‡‡æ ·ï¼‰
        v_k = v0
        for _ in range(k):
            p_h_k, h_k = self.sample_h(v_k)
            p_v_k, v_k = self.sample_v(h_k)
        
        # è®¡ç®—æ¢¯åº¦
        positive_grad = torch.matmul(v0.t(), p_h0)
        negative_grad = torch.matmul(v_k.t(), p_h_k)
        
        return positive_grad - negative_grad
    
    def forward(self, v):
        """å‰å‘ä¼ æ’­"""
        p_h, h = self.sample_h(v)
        return p_h

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # åˆ›å»ºRBM
    rbm = RBM(n_visible=784, n_hidden=500)
    
    # æ¨¡æ‹Ÿè¾“å…¥ï¼ˆäºŒå€¼åŒ–å›¾åƒï¼‰
    v0 = torch.rand(32, 784)
    v0 = (v0 > 0.5).float()
    
    # å‰å‘ä¼ æ’­
    h = rbm(v0)
    print(f"éšè—å±‚å½¢çŠ¶: {h.shape}")  # [32, 500]
    
    # å¯¹æ¯”æ•£åº¦ï¼ˆç”¨äºè®­ç»ƒï¼‰
    grad = rbm.contrastive_divergence(v0, k=1)
    print(f"æ¢¯åº¦å½¢çŠ¶: {grad.shape}")  # [784, 500]</code></pre>
                </div>
                <div class="code-box">
                    <h3>DBN é€å±‚é¢„è®­ç»ƒ</h3>
                    <pre><code class="language-python">import torch
import torch.nn as nn
from torch.optim import Adam

class DBN(nn.Module):
    """æ·±åº¦ä¿¡å¿µç½‘ç»œ"""
    def __init__(self, layers):
        super(DBN, self).__init__()
        self.layers = nn.ModuleList([RBM(layers[i], layers[i+1]) 
                                     for i in range(len(layers)-1)])
    
    def pretrain_layer(self, layer_idx, data, epochs=10):
        """é¢„è®­ç»ƒå•å±‚RBM"""
        rbm = self.layers[layer_idx]
        optimizer = Adam(rbm.parameters(), lr=0.01)
        
        for epoch in range(epochs):
            # è·å–å½“å‰å±‚çš„è¾“å…¥
            if layer_idx == 0:
                input_data = data
            else:
                with torch.no_grad():
                    input_data = self.layers[layer_idx-1](data)
            
            # å¯¹æ¯”æ•£åº¦
            grad = rbm.contrastive_divergence(input_data)
            
            # æ›´æ–°æƒé‡ï¼ˆç®€åŒ–ç‰ˆï¼‰
            optimizer.zero_grad()
            loss = -torch.sum(grad * rbm.W)
            loss.backward()
            optimizer.step()
            
            if (epoch + 1) % 5 == 0:
                print(f"Layer {layer_idx}, Epoch {epoch+1}, Loss: {loss.item():.4f}")

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # åˆ›å»ºDBN: 784 -> 500 -> 250 -> 100
    dbn = DBN([784, 500, 250, 100])
    
    # æ¨¡æ‹Ÿæ•°æ®
    data = torch.rand(100, 784)
    data = (data > 0.5).float()
    
    # é€å±‚é¢„è®­ç»ƒ
    for i in range(len(dbn.layers)):
        print(f"é¢„è®­ç»ƒç¬¬ {i+1} å±‚...")
        dbn.pretrain_layer(i, data, epochs=10)</code></pre>
                </div>
            </div>
        </div>
    </div>
    <!-- å›¾ç‰‡æ”¾å¤§å¼¹çª— -->
    <div id="imageModal" class="image-modal" onclick="closeImageModal()">
        <span class="image-modal-close" onclick="event.stopPropagation(); closeImageModal()">&times;</span>
        <img id="modalImage" class="image-modal-content" src="" alt="">
        <div id="modalCaption" class="image-modal-caption"></div>
    </div>
    <script>
        function openImageModal(img) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            const modalCaption = document.getElementById('modalCaption');
            modal.classList.add('active');
            modalImg.src = img.src;
            modalCaption.textContent = img.alt || '';
            modalImg.onclick = function(e) { e.stopPropagation(); };
        }
        function closeImageModal() {
            document.getElementById('imageModal').classList.remove('active');
        }
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') closeImageModal();
        });
    </script>
    <!-- å…¬å…±è„šæœ¬ -->
    <script src="../common/tech-document.js"></script>
</body>
</html>

