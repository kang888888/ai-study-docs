<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>专家混合（Mixture of Experts, MoE）</title>
    <script>
        window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']] }, options: { skipHtmlTags: ['script','noscript','style','textarea','pre','code'] } };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <!-- 公共样式 -->
    <link rel="stylesheet" href="../common/styles.css">
</head>
<body>
    <div class="container">
        <h1>专家混合（Mixture of Experts, MoE）</h1>
        <p class="tagline">将多个专家模型组合成一个强大的模型，在保持效率的同时提升性能。</p>

        <div class="meta-grid">
            <div class="meta-card"><h3>核心特点</h3><p>专家混合、高效推理、任务特化、灵活组合。</p></div>
            <div class="meta-card"><h3>架构组成</h3><p>门控网络、专家网络、组合器、输出层。</p></div>
            <div class="meta-card"><h3>主要优势</h3><p>参数效率、推理速度快、任务适应性强、可扩展。</p></div>
            <div class="meta-card"><h3>应用场景</h3><p>多任务处理、专业化模型、高效推理、大规模模型。</p></div>
        </div>

        <div class="section">
            <h2>⚙️ 核心原理</h2>
            <ul>
                <li><strong>门控网络</strong>：路由网络，决定激活哪些专家</li>
                <li><strong>专家网络</strong>：多个专家网络，每个专注特定任务</li>
                <li><strong>组合器</strong>：合并专家输出</li>
                <li><strong>输出层</strong>：生成最终结果</li>
            </ul>
        </div>

        <div class="section">
            <h2>🔧 专家激活机制</h2>
            <ol>
                <li><strong>输入通过门控网络</strong>：计算每个专家的激活概率</li>
                <li><strong>选择top-k专家</strong>：选择激活概率最高的k个专家</li>
                <li><strong>计算加权输出</strong>：根据激活概率加权组合专家输出</li>
            </ol>
        </div>

        <div class="section">
            <h2>💻 代码示例</h2>
            <div class="code-box">
                <h3>使用MergeKit创建MoE</h3>
                <pre><code class="language-python"># MoE配置
moe_config = {
    "experts": [
        {
            "model": "microsoft/DialoGPT-medium",
            "expert_name": "dialogue_expert",
            "weight": 0.3
        },
        {
            "model": "microsoft/CodeGPT-small-py",
            "expert_name": "code_expert", 
            "weight": 0.3
        }
    ],
    "gate_config": {
        "hidden_size": 768,
        "num_experts": 2,
        "top_k": 2
    },
    "output_path": "./frankenmoe_model"
}

# 创建MoE
from mergekit.moe import MoEMerger
moe_merger = MoEMerger()
frankenmoe = moe_merger.create_moe(moe_config)</code></pre>
            </div>
        </div>

        <div class="section">
            <h2>📊 主要优势</h2>
            <ul>
                <li><strong>参数效率</strong>：比单一模型参数更少</li>
                <li><strong>推理速度</strong>：只激活部分专家，推理更快</li>
                <li><strong>任务适应</strong>：不同专家处理不同任务</li>
                <li><strong>可扩展性</strong>：容易添加新专家</li>
            </ul>
        </div>
    </div>
    <!-- 公共脚本 -->
    <script src="../common/tech-document.js"></script>
</body>
</html>

