<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GNN (Graph Neural Network) å›¾ç¥ç»ç½‘ç»œ - æ¶æ„è¯¦è§£</title>
    <!-- MathJax for mathematical formulas -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Prism.js for code highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <!-- å…¬å…±æ ·å¼ -->
    <link rel="stylesheet" href="../common/styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>GNN (Graph Neural Network) å›¾ç¥ç»ç½‘ç»œ</h1>
            <p>ä¸“é—¨å¤„ç†å›¾ç»“æ„æ•°æ®çš„ç¥ç»ç½‘ç»œ</p>
        </div>
        <div class="content">
            
            
            <div class="section">
                <h2>ğŸ“– æ ¸å¿ƒæ¦‚å¿µ</h2>
                <div class="desc-box">
                    <p>ä¸“é—¨å¤„ç†å›¾ç»“æ„æ•°æ®ï¼ˆèŠ‚ç‚¹+è¾¹ï¼‰çš„ç¥ç»ç½‘ç»œã€‚é€šè¿‡æ¶ˆæ¯ä¼ é€’æœºåˆ¶ï¼ˆMessage Passingï¼‰ï¼Œè®©èŠ‚ç‚¹èšåˆé‚»å±…èŠ‚ç‚¹çš„ä¿¡æ¯ï¼Œå­¦ä¹ å›¾çš„è¡¨ç¤ºã€‚</p>
                </div>
            </div>

            <div class="section features">
                <h2>ğŸŒŸ æ ¸å¿ƒç‰¹ç‚¹</h2>
                <ul>
                    <li>æ¶ˆæ¯ä¼ é€’ï¼šèŠ‚ç‚¹ä»é‚»å±…èŠ‚ç‚¹èšåˆä¿¡æ¯ï¼Œæ›´æ–°è‡ªèº«è¡¨ç¤º</li>
                    <li>æ’åˆ—ä¸å˜æ€§ï¼šå¯¹èŠ‚ç‚¹é¡ºåºä¸æ•æ„Ÿ</li>
                    <li>å½’çº³å­¦ä¹ ï¼šå¯ä»¥æ³›åŒ–åˆ°è®­ç»ƒæ—¶æœªè§è¿‡çš„å›¾</li>
                    <li>å¤šç§å˜ä½“ï¼šGCNã€GraphSAGEã€GATï¼ˆå›¾æ³¨æ„åŠ›ï¼‰</li>
                    <li>éæ¬§å‡ é‡Œå¾—æ•°æ®ï¼šå¤„ç†ä¸è§„åˆ™ç»“æ„æ•°æ®</li>
                </ul>
            </div>

            <div class="section">
                <h2>âš™ï¸ å…³é”®æŠ€æœ¯</h2>
                <div class="tech-box">
                    <p><strong>æ¶ˆæ¯ä¼ é€’ï¼ˆMessage Passingï¼‰ã€èšåˆå‡½æ•°ï¼ˆAggregationï¼‰ã€å›¾æ³¨æ„åŠ›ï¼ˆGATï¼‰</strong></p>
                </div>
            </div>

            <div class="section">
                <h2>ğŸš€ åº”ç”¨åœºæ™¯</h2>
                <div class="app-box">
                    <p>ç¤¾äº¤ç½‘ç»œåˆ†æã€åˆ†å­æ€§è´¨é¢„æµ‹ã€æ¨èç³»ç»Ÿã€çŸ¥è¯†å›¾è°±ã€äº¤é€šé¢„æµ‹</p>
                </div>
            </div>

            <div class="section">
                <h2>ğŸ“Š æ¶æ„å›¾è§£</h2>
                <div class="diagram-gallery">
                    <div class="diagram-item">
                        <img src="GNNå›¾ç»“æ„.png" alt="GNNå›¾ç»“æ„" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'">
                        <div class="caption">GNNå›¾ç»“æ„</div>
                    </div>
                    <div class="diagram-item">
                        <img src="GNNæ¶ˆæ¯ä¼ é€’.png" alt="GNNæ¶ˆæ¯ä¼ é€’" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'">
                        <div class="caption">GNNæ¶ˆæ¯ä¼ é€’</div>
                    </div>
                    <div class="diagram-item">
                        <img src="GNNå¤šå±‚ç»“æ„.png" alt="GNNå¤šå±‚ç»“æ„" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'">
                        <div class="caption">GNNå¤šå±‚ç»“æ„</div>
                    </div>
                    <div class="diagram-item">
                        <img src="GATæ³¨æ„åŠ›æƒé‡.png" alt="GATæ³¨æ„åŠ›æƒé‡" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'">
                        <div class="caption">GATæ³¨æ„åŠ›æƒé‡</div>
                    </div>
                    <div class="diagram-item">
                        <img src="èŠ‚ç‚¹åµŒå…¥å­¦ä¹ .png" alt="èŠ‚ç‚¹åµŒå…¥å­¦ä¹ " onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'">
                        <div class="caption">èŠ‚ç‚¹åµŒå…¥å­¦ä¹ </div>
                    </div>
                    <div class="diagram-item">
                        <img src="GNNå˜ä½“å¯¹æ¯”.png" alt="GNNå˜ä½“å¯¹æ¯”" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'">
                        <div class="caption">GNNå˜ä½“å¯¹æ¯”</div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>ğŸ“ æ•°å­¦åŸç†</h2>
                <div class="math-box">
                    <h3>æ¶ˆæ¯ä¼ é€’æœºåˆ¶</h3>
                    <div class="math-formula">
                        <p>GNNçš„æ ¸å¿ƒæ˜¯æ¶ˆæ¯ä¼ é€’ï¼š</p>
                        <p>$$h_v^{(l+1)} = \text{UPDATE}^{(l)}\left(h_v^{(l)}, \text{AGGREGATE}^{(l)}\left(\{h_u^{(l)} : u \in \mathcal{N}(v)\}\right)\right)$$</p>
                        <p>å…¶ä¸­ï¼š</p>
                        <ul style="list-style: none; padding-left: 20px;">
                            <li>$h_v^{(l)}$ æ˜¯èŠ‚ç‚¹ $v$ åœ¨ç¬¬ $l$ å±‚çš„è¡¨ç¤º</li>
                            <li>$\mathcal{N}(v)$ æ˜¯èŠ‚ç‚¹ $v$ çš„é‚»å±…é›†åˆ</li>
                            <li>$\text{AGGREGATE}$ æ˜¯èšåˆå‡½æ•°ï¼ˆå¦‚meanã€maxã€sumï¼‰</li>
                            <li>$\text{UPDATE}$ æ˜¯æ›´æ–°å‡½æ•°</li>
                        </ul>
                    </div>
                </div>
                <div class="math-box">
                    <h3>å›¾å·ç§¯ç½‘ç»œï¼ˆGCNï¼‰</h3>
                    <div class="math-formula">
                        <p>GCNçš„æ›´æ–°å…¬å¼ï¼š</p>
                        <p>$$H^{(l+1)} = \sigma\left(\tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}} H^{(l)} W^{(l)}\right)$$</p>
                        <p>å…¶ä¸­ $\tilde{A} = A + I$ æ˜¯å¸¦è‡ªç¯çš„é‚»æ¥çŸ©é˜µï¼Œ$\tilde{D}$ æ˜¯åº¦çŸ©é˜µ</p>
                    </div>
                </div>
                <div class="math-box">
                    <h3>å›¾æ³¨æ„åŠ›ç½‘ç»œï¼ˆGATï¼‰</h3>
                    <div class="math-formula">
                        <p>GATä½¿ç”¨æ³¨æ„åŠ›æœºåˆ¶ï¼š</p>
                        <p>$$\alpha_{ij} = \frac{\exp(\text{LeakyReLU}(a^T [Wh_i || Wh_j]))}{\sum_{k \in \mathcal{N}(i)} \exp(\text{LeakyReLU}(a^T [Wh_i || Wh_k]))}$$</p>
                        <p>$$h_i^{(l+1)} = \sigma\left(\sum_{j \in \mathcal{N}(i)} \alpha_{ij} W^{(l)} h_j^{(l)}\right)$$</p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>ğŸ’» Python ä»£ç ç¤ºä¾‹</h2>
                <div class="code-box">
                    <h3>ä½¿ç”¨ PyTorch Geometric å®ç° GCN</h3>
                    <pre><code class="language-python">import torch
import torch.nn as nn
import torch.nn.functional as F
from torch_geometric.nn import GCNConv

class GCN(nn.Module):
    """å›¾å·ç§¯ç½‘ç»œ"""
    def __init__(self, num_features, hidden_dim, num_classes):
        super(GCN, self).__init__()
        self.conv1 = GCNConv(num_features, hidden_dim)
        self.conv2 = GCNConv(hidden_dim, num_classes)
        self.dropout = nn.Dropout(0.5)
    
    def forward(self, x, edge_index):
        """
        å‚æ•°:
            x: èŠ‚ç‚¹ç‰¹å¾ [num_nodes, num_features]
            edge_index: è¾¹ç´¢å¼• [2, num_edges]
        """
        x = self.conv1(x, edge_index)
        x = F.relu(x)
        x = self.dropout(x)
        x = self.conv2(x, edge_index)
        return F.log_softmax(x, dim=1)

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # åˆ›å»ºæ¨¡å‹
    model = GCN(num_features=1433, hidden_dim=64, num_classes=7)
    
    # æ¨¡æ‹Ÿå›¾æ•°æ®
    num_nodes = 2708
    num_features = 1433
    x = torch.randn(num_nodes, num_features)
    edge_index = torch.randint(0, num_nodes, (2, 10556))
    
    # å‰å‘ä¼ æ’­
    output = model(x, edge_index)
    print(f"è¾“å‡ºå½¢çŠ¶: {output.shape}")  # [2708, 7]</code></pre>
                </div>
                <div class="code-box">
                    <h3>æ‰‹åŠ¨å®ç°ç®€å•çš„ GNN å±‚</h3>
                    <pre><code class="language-python">import torch
import torch.nn as nn

class SimpleGNNLayer(nn.Module):
    """ç®€å•çš„GNNå±‚"""
    def __init__(self, in_dim, out_dim):
        super(SimpleGNNLayer, self).__init__()
        self.linear = nn.Linear(in_dim, out_dim)
    
    def forward(self, x, adj):
        """
        å‚æ•°:
            x: èŠ‚ç‚¹ç‰¹å¾ [num_nodes, in_dim]
            adj: é‚»æ¥çŸ©é˜µ [num_nodes, num_nodes]
        """
        # æ¶ˆæ¯ä¼ é€’ï¼šèšåˆé‚»å±…ä¿¡æ¯
        support = self.linear(x)  # [num_nodes, out_dim]
        output = torch.matmul(adj, support)  # [num_nodes, out_dim]
        return output

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    layer = SimpleGNNLayer(in_dim=64, out_dim=32)
    x = torch.randn(100, 64)
    adj = torch.randn(100, 100)
    adj = (adj > 0).float()  # äºŒå€¼åŒ–é‚»æ¥çŸ©é˜µ
    
    output = layer(x, adj)
    print(f"è¾“å‡ºå½¢çŠ¶: {output.shape}")  # [100, 32]</code></pre>
                </div>
            </div>
        </div>
    </div>
    <!-- å›¾ç‰‡æ”¾å¤§å¼¹çª— -->
    <div id="imageModal" class="image-modal" onclick="closeImageModal()">
        <span class="image-modal-close" onclick="event.stopPropagation(); closeImageModal()">&times;</span>
        <img id="modalImage" class="image-modal-content" src="" alt="">
        <div id="modalCaption" class="image-modal-caption"></div>
    </div>
    <script>
        function openImageModal(img) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            const modalCaption = document.getElementById('modalCaption');
            modal.classList.add('active');
            modalImg.src = img.src;
            modalCaption.textContent = img.alt || '';
            modalImg.onclick = function(e) { e.stopPropagation(); };
        }
        function closeImageModal() {
            document.getElementById('imageModal').classList.remove('active');
        }
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') closeImageModal();
        });
    </script>
    <!-- å…¬å…±è„šæœ¬ -->
    <script src="../common/tech-document.js"></script>
</body>
</html>

