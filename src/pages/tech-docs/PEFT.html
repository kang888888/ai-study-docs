<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PEFTï¼ˆParameter-Efficient Fine-Tuningï¼‰- æŠ€æœ¯è¯¦è§£</title>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <!-- å…¬å…±æ ·å¼ -->
    <link rel="stylesheet" href="../common/styles.css">
</head>
<body>
    <div class="container">
        <h1>PEFTï¼šå‚æ•°é«˜æ•ˆå¾®è°ƒæ–¹æ³•æ—</h1>
        <p class="tagline">é€šè¿‡ Adapterã€Prefix-Tuningã€LoRAã€IA3ã€BitFit ç­‰æ–¹æ³•å†»ç»“å¤§éƒ¨åˆ†å‚æ•°ï¼Œä»…è®­ç»ƒå°å‹é™„åŠ æ¨¡å—ï¼Œå®ç°â€œä½èµ„æºå¯æ‰©å±•â€ã€‚</p>

        <div class="meta-grid">
            <div class="meta-card">
                <h3>ç›®æ ‡</h3>
                <p>åœ¨æœ‰é™ç®—åŠ›ä¸‹å¿«é€Ÿè¿­ä»£å¤šä¸ªä»»åŠ¡/é¢†åŸŸçš„å®šåˆ¶æ¨¡å‹ï¼Œä¾¿äºéƒ¨ç½²ä¸ç‰ˆæœ¬åŒ–ã€‚</p>
            </div>
            <div class="meta-card">
                <h3>å¸¸è§æ‰‹æ®µ</h3>
                <p>LoRA/QLoRAã€Adapterã€Prefix-Tuningã€P-Tuning v2ã€Prompt Tuningã€BitFitã€IA3ã€‚</p>
            </div>
            <div class="meta-card">
                <h3>ä¼˜åŠ¿</h3>
                <p>æ˜¾å­˜å ç”¨ä½ã€è®­ç»ƒç¨³å®šã€å‚æ•°å¯ç»„åˆã€æ”¯æŒå¤šä»»åŠ¡å…±äº«ã€‚</p>
            </div>
            <div class="meta-card">
                <h3>ç”Ÿæ€</h3>
                <p>Hugging Face PEFT åº“ç»Ÿä¸€äº† APIï¼Œå…¼å®¹ Transformers/TRL/Axolotlã€‚</p>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ§© æŠ€æœ¯è¦ç‚¹</h2>
            <ul>
                <li><strong>æ¨¡å—åŒ–æ³¨å…¥ï¼š</strong>åœ¨æ³¨æ„åŠ›æˆ–å‰é¦ˆå±‚æ’å…¥å¯è®­ç»ƒæ¨¡å—ï¼Œä¸»å¹²ä¿æŒå†»ç»“ã€‚</li>
                <li><strong>Prompt å‚æ•°åŒ–ï¼š</strong>å°†ä»»åŠ¡çŸ¥è¯†ç¼–ç ä¸ºå¯è®­ç»ƒ prompt å‘é‡ï¼Œä¸ä¿®æ”¹æ¨¡å‹æƒé‡ã€‚</li>
                <li><strong>Adapter ç»„åˆï¼š</strong>åŒä¸€æ¨¡å‹å¯åŠ è½½å¤šä¸ªé€‚é…å™¨ï¼ŒæŒ‰éœ€åˆ‡æ¢é¢†åŸŸã€‚</li>
                <li><strong>æƒé‡åˆå¹¶/æ‹†åˆ†ï¼š</strong>LoRA/Adapter å¯ä»¥åœ¨å¯¼å‡ºæ—¶åˆå¹¶è¿›åŸæ¨¡å‹ï¼Œæˆ–ä»¥å¢é‡å½¢å¼åˆ†å‘ã€‚</li>
            </ul>
        </div>

        <div class="section">
            <h2>ğŸ“Š å›¾è§£</h2>
            <div class="diagram-gallery">
                <div class="diagram-item">
                    <img src="./assets/PEFTå®¶æ—.png" alt="PEFT æ–¹æ³•å®¶æ—" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'">
                    <div class="caption">æ–¹æ³•å®¶æ—</div>
                </div>
                <div class="diagram-item">
                    <img src="./assets/Adapterç»“æ„.png" alt="Adapter ç»“æ„" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'">
                    <div class="caption">Adapter ç»“æ„</div>
                </div>
                <div class="diagram-item">
                    <img src="./assets/PromptTuning.png" alt="Prompt Tuning" onclick="openImageModal(this)" onerror="this.parentElement.style.display='none'">
                    <div class="caption">Prompt Tuning</div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ“ æ•°å­¦åŸç†</h2>
            <div class="math-box">
                <h3>Adapter</h3>
                <div class="math-formula">
                    <p>Adapter åœ¨å±‚å†…æ·»åŠ ç“¶é¢ˆç»“æ„ï¼š</p>
                    <p>$$h' = h + W_{up} \sigma(W_{down} h)$$</p>
                    <p>$W_{down} \in \mathbb{R}^{d \times r}, W_{up} \in \mathbb{R}^{r \times d}$ï¼Œä»…è®­ç»ƒè¿™ä¸¤å±‚ã€‚</p>
                </div>
            </div>
            <div class="math-box">
                <h3>Prefix/Prompt Tuning</h3>
                <div class="math-formula">
                    <p>åœ¨å¤šå¤´æ³¨æ„åŠ›å‰æ³¨å…¥è™šæ‹Ÿ tokenï¼š</p>
                    <p>$$\text{Attention}(Q, K, V) \Rightarrow \text{Attention}([Q; Q_p], [K; K_p], [V; V_p])$$</p>
                    <p>$Q_p,K_p,V_p$ ä¸ºå¯è®­ç»ƒå‰ç¼€å‘é‡ã€‚</p>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ’» ä»£ç ç¤ºä¾‹</h2>
            <div class="code-box">
                <h3>PEFT ç»Ÿä¸€æ¥å£</h3>
                <pre><code class="language-python">from peft import (LoraConfig, PrefixTuningConfig, PromptTuningConfig,
                   get_peft_model, TaskType)
from transformers import AutoModelForSeq2SeqLM, AutoTokenizer

base_model = "google/flan-t5-large"
model = AutoModelForSeq2SeqLM.from_pretrained(base_model)

lora_cfg = LoraConfig(
    task_type=TaskType.SEQ_2_SEQ_LM,
    r=8,
    lora_alpha=32,
    lora_dropout=0.05,
    target_modules=["q", "v"]
)
model = get_peft_model(model, lora_cfg)

# ä¹Ÿå¯åˆ‡æ¢ä¸º Prefix Tuning
# prefix_cfg = PrefixTuningConfig(task_type=TaskType.SEQ_2_SEQ_LM, num_virtual_tokens=30)
# model = get_peft_model(model, prefix_cfg)
</code></pre>
            </div>
        </div>
    </div>

    <div id="imageModal" class="image-modal" onclick="closeImageModal()">
        <span class="image-modal-close" onclick="event.stopPropagation(); closeImageModal();">&times;</span>
        <img id="modalImage" class="image-modal-content" src="" alt="">
        <div id="modalCaption" class="image-modal-caption"></div>
    </div>

    <script>
        function openImageModal(img) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            const modalCaption = document.getElementById('modalCaption');
            modal.classList.add('active');
            modalImg.src = img.src;
            modalCaption.textContent = img.alt || '';
        }
        function closeImageModal() {
            document.getElementById('imageModal').classList.remove('active');
        }
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') closeImageModal();
        });
    </script>
    <!-- å…¬å…±è„šæœ¬ -->
    <script src="../common/tech-document.js"></script>
</body>
</html>
