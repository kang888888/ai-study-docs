{
  "title": "Speculative Decodingï¼ˆæ¨æµ‹è§£ç ï¼‰",
  "subtitle": "ä½¿ç”¨è½»é‡ Draft æ¨¡å‹ä¸€æ¬¡ç”Ÿæˆå¤š tokenï¼Œå†ç”±å¤§æ¨¡å‹å¿«é€ŸéªŒè¯ï¼Œæ˜¾è‘—æå‡é•¿æ–‡æœ¬ååã€‚",
  "content": [
    {
      "type": "section",
      "title": "ğŸ“– æ ¸å¿ƒæ¦‚å¿µ",
      "content": [
        {
          "type": "desc-box",
          "content": [
            "æ¨æµ‹è§£ç ä½¿ç”¨è¾ƒå°çš„è‰ç¨¿æ¨¡å‹ç”Ÿæˆå€™é€‰åºåˆ—ï¼Œä¸»æ¨¡å‹å¹¶è¡ŒéªŒè¯ï¼Œé€šè¿‡å¹¶è¡Œè®¡ç®—åŠ é€Ÿç”Ÿæˆè¿‡ç¨‹ã€‚"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸŒŸ æ ¸å¿ƒç‰¹ç‚¹",
      "content": [
        {
          "type": "features",
          "items": [
            "å¹¶è¡ŒåŠ é€Ÿï¼šè‰ç¨¿æ¨¡å‹å’Œä¸»æ¨¡å‹å¹¶è¡Œ",
            "è´¨é‡ä¿è¯ï¼šä¸»æ¨¡å‹éªŒè¯ä¿è¯è¾“å‡ºè´¨é‡",
            "ååæå‡ï¼šå¯æå‡2-3å€ç”Ÿæˆé€Ÿåº¦",
            "èµ„æºéœ€æ±‚ï¼šéœ€è¦é¢å¤–çš„è‰ç¨¿æ¨¡å‹",
            "é€‚ç”¨åœºæ™¯ï¼šé€‚åˆæ‰¹é‡ç”Ÿæˆä»»åŠ¡"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "âš™ï¸ å…³é”®æŠ€æœ¯",
      "content": [
        {
          "type": "tech-box",
          "content": "è‰ç¨¿æ¨¡å‹ã€å¹¶è¡ŒéªŒè¯ã€æ¥å—/æ‹’ç»æœºåˆ¶ã€ååä¼˜åŒ–"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸš€ åº”ç”¨åœºæ™¯",
      "content": [
        {
          "type": "app-box",
          "content": "æ‰¹é‡ç”Ÿæˆã€é«˜ååæ¨ç†ã€å¹¶è¡Œç”Ÿæˆã€åŠ é€Ÿæ¨ç†ã€æœåŠ¡ä¼˜åŒ–"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“Š å›¾è§£",
      "content": [
        {
          "type": "diagram-gallery",
          "images": [
            {
              "type": "svg-d3",
              "component": "SpeculativeDecodingDiagram",
              "caption": "æ•´ä½“æµç¨‹",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "flow",
                "title": "Speculative Decoding æ•´ä½“æµç¨‹"
              }
            },
            {
              "type": "svg-d3",
              "component": "SpeculativeDecodingDiagram",
              "caption": "æ‹’ç»ä¸å›é€€",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "reject",
                "title": "æ‹’ç»ä¸å›é€€æœºåˆ¶"
              }
            },
            {
              "type": "svg-d3",
              "component": "SpeculativeDecodingDiagram",
              "caption": "å¹¶è¡Œè°ƒåº¦",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "parallel",
                "title": "å¹¶è¡Œè°ƒåº¦æœºåˆ¶"
              }
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“ æ•°å­¦åŸç†",
      "content": [
        {
          "type": "math-box",
          "title": "æ¥å—æ¦‚ç‡",
          "formulas": [
            {
              "text": "ç»™å®š Draft è¾“å‡º $x_{1:K}$ï¼Œæ¥å—æ¡ä»¶ï¼š",
              "inline": "x_{1:K}"
            },
            {
              "display": "u < \\frac{p_T(x_i | x_{<i})}{p_D(x_i | x_{<i})}"
            },
            {
              "text": "$u \\sim \\mathcal{U}(0,1)$ï¼Œ$p_T$ ä¸º Target æ¦‚ç‡ï¼Œ$p_D$ ä¸º Draftã€‚",
              "inline": "u \\sim \\mathcal{U}(0,1)"
            }
          ]
        },
        {
          "type": "math-box",
          "title": "åŠ é€Ÿæ¯”",
          "formulas": [
            {
              "display": "\\text{Speedup} \\approx \\frac{K}{1 + r K}"
            },
            {
              "text": "$r$ ä¸ºæ‹’ç»ç‡ã€‚é€‰æ‹©åˆé€‚ K ä»¥æœ€å¤§åŒ–åŠ é€Ÿæ¯”ã€‚",
              "inline": "r"
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ’» ä»£ç ç¤ºä¾‹ï¼ˆvLLMï¼‰",
      "content": [
        {
          "type": "code-box",
          "title": "",
          "language": "python",
          "code": "from vllm import SAMPLING_SPEC\n\nspec = SAMPLING_SPEC.from_dict({\n    \"draft_model\": \"meta-llama/Llama-2-7b\",\n    \"target_model\": \"meta-llama/Llama-3-8b\",\n    \"draft_k\": 4,\n    \"max_new_tokens\": 256\n})\n\noutputs = llm.generate([\"è§£é‡Š speculative decoding\"], spec.to_sampling_params())\nprint(outputs[0].outputs[0].text)"
        }
      ]
    }
  ]
}