{
  "title": "Mamba (State Space Models) çŠ¶æ€ç©ºé—´æ¨¡å‹",
  "subtitle": "çº¿æ€§å¤æ‚åº¦çš„é•¿åºåˆ—å»ºæ¨¡æ¶æ„",
  "content": [
    {
      "type": "section",
      "title": "ğŸ“– æ ¸å¿ƒæ¦‚å¿µ",
      "content": [
        {
          "type": "desc-box",
          "content": [
            "åŸºäºç»“æ„åŒ–çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆSSMï¼‰çš„æ–°å‹æ¶æ„ï¼Œæ—¨åœ¨è§£å†³Transformeråœ¨é•¿åºåˆ—ä¸Šçš„O(LÂ²)å¤æ‚åº¦å’ŒKV Cacheæ˜¾å­˜å ç”¨é—®é¢˜ã€‚é€šè¿‡é€‰æ‹©æ€§æ‰«ææœºåˆ¶å®ç°çº¿æ€§å¤æ‚åº¦ã€‚"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸŒŸ æ ¸å¿ƒç‰¹ç‚¹",
      "content": [
        {
          "type": "features",
          "items": [
            "çº¿æ€§å¤æ‚åº¦ï¼šæ—¶é—´å’Œç©ºé—´å¤æ‚åº¦å‡ä¸ºO(L)ï¼Œè¿œä¼˜äºTransformerçš„O(LÂ²)",
            "æ— KV Cacheï¼šæ¨ç†æ—¶æ˜¾å­˜å ç”¨æ’å®šï¼Œä¸éšåºåˆ—é•¿åº¦å¢é•¿",
            "é€‰æ‹©æ€§æœºåˆ¶ï¼šå‚æ•°æ ¹æ®è¾“å…¥åŠ¨æ€å˜åŒ–ï¼Œç±»ä¼¼Attentionçš„å†…å®¹é€‰æ‹©èƒ½åŠ›",
            "å¹¶è¡Œè®­ç»ƒï¼šé€šè¿‡å¹¶è¡Œæ‰«æç®—æ³•æ”¯æŒé«˜æ•ˆå¹¶è¡Œè®­ç»ƒ",
            "RNNæ¨ç†ï¼šæ¨ç†æ—¶å¯ä»¥é€’å½’è®¡ç®—ï¼Œé€Ÿåº¦æå¿«"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "âš™ï¸ å…³é”®æŠ€æœ¯",
      "content": [
        {
          "type": "tech-box",
          "content": "é€‰æ‹©æ€§çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆSelective SSMï¼‰ã€å¹¶è¡Œæ‰«æç®—æ³•ã€ç¡¬ä»¶æ„ŸçŸ¥ä¼˜åŒ–"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸš€ åº”ç”¨åœºæ™¯",
      "content": [
        {
          "type": "app-box",
          "content": "é•¿æ–‡æœ¬ç”Ÿæˆã€åŸºå› ç»„åºåˆ—åˆ†æã€æ—¶é—´åºåˆ—å»ºæ¨¡ã€ä»£ç ç”Ÿæˆï¼ˆCodestral Mambaï¼‰"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“Š æ¶æ„å›¾è§£",
      "content": [
        {
          "type": "diagram-gallery",
          "images": [
            {
              "type": "svg-d3",
              "component": "MambaDiagram",
              "caption": "Mamba vs Transformer",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "Mamba vs Transformer"
              }
            },
            {
              "type": "svg-d3",
              "component": "MambaDiagram",
              "caption": "Mambaç»„ä»¶è¯¦è§£",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "Mambaç»„ä»¶è¯¦è§£"
              }
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“ æ•°å­¦åŸç†",
      "content": [
        {
          "type": "math-box",
          "title": "çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆSSMï¼‰",
          "formulas": [
            {
              "text": "è¿ç»­æ—¶é—´SSMï¼š"
            },
            {
              "display": "h'(t) = Ah(t) + Bx(t)"
            },
            {
              "display": "y(t) = Ch(t)"
            },
            {
              "text": "ç¦»æ•£åŒ–åï¼š"
            },
            {
              "display": "h_k = \\bar{A}h_{k-1} + \\bar{B}x_k"
            },
            {
              "display": "y_k = Ch_k"
            },
            {
              "text": "å…¶ä¸­ $\\bar{A} = e^{\\Delta A}$ï¼Œ$\\bar{B} = (\\Delta A)^{-1}(e^{\\Delta A} - I)\\Delta B$",
              "inline": "\\bar{A} = e^{\\Delta A}"
            }
          ]
        },
        {
          "type": "math-box",
          "title": "é€‰æ‹©æ€§æœºåˆ¶",
          "formulas": [
            {
              "text": "Mambaçš„å…³é”®åˆ›æ–°æ˜¯è®©å‚æ•°ä¾èµ–äºè¾“å…¥ï¼š"
            },
            {
              "display": "B_k = s_B(x_k), \\quad C_k = s_C(x_k), \\quad \\Delta_k = \\tau_\\Delta(x_k)"
            },
            {
              "text": "è¿™ä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ ¹æ®è¾“å…¥å†…å®¹åŠ¨æ€è°ƒæ•´çŠ¶æ€è½¬ç§»ï¼Œå®ç°ç±»ä¼¼Attentionçš„é€‰æ‹©èƒ½åŠ›"
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ’» Python ä»£ç ç¤ºä¾‹",
      "content": [
        {
          "type": "code-box",
          "title": "ä½¿ç”¨ mamba-ssm åº“å®ç° Mamba",
          "language": "python",
          "code": "import torch\nfrom mamba_ssm import Mamba\n\n# åˆ›å»º Mamba æ¨¡å‹\nmodel = Mamba(\n    d_model=512,        # æ¨¡å‹ç»´åº¦\n    d_state=16,         # çŠ¶æ€ç»´åº¦\n    d_conv=4,           # å·ç§¯æ ¸å¤§å°\n    expand=2,           # æ‰©å±•å› å­\n)\n\n# è¾“å…¥ (batch_size, seq_length, d_model)\nx = torch.randn(2, 1024, 512)\n\n# å‰å‘ä¼ æ’­\noutput = model(x)\nprint(f\"è¾“å‡ºå½¢çŠ¶: {output.shape}\")  # [2, 1024, 512]\n\n# ä¸ Transformer å¯¹æ¯”\n# Transformer: O(LÂ²) å¤æ‚åº¦ï¼Œéœ€è¦ KV Cache\n# Mamba: O(L) å¤æ‚åº¦ï¼Œæ— éœ€ KV Cache"
        },
        {
          "type": "code-box",
          "title": "æ‰‹åŠ¨å®ç°ç®€åŒ–ç‰ˆ SSM",
          "language": "python",
          "code": "import torch\nimport torch.nn as nn\n\nclass SimpleSSM(nn.Module):\n    \"\"\"ç®€åŒ–çš„çŠ¶æ€ç©ºé—´æ¨¡å‹\"\"\"\n    def __init__(self, d_model, d_state):\n        super(SimpleSSM, self).__init__()\n        self.d_model = d_model\n        self.d_state = d_state\n        \n        # çŠ¶æ€è½¬ç§»çŸ©é˜µ\n        self.A = nn.Parameter(torch.randn(d_state, d_state))\n        # è¾“å…¥çŸ©é˜µ\n        self.B = nn.Linear(d_model, d_state)\n        # è¾“å‡ºçŸ©é˜µ\n        self.C = nn.Linear(d_state, d_model)\n    \n    def forward(self, x):\n        \"\"\"\n        å‚æ•°:\n            x: [batch_size, seq_length, d_model]\n        è¿”å›:\n            output: [batch_size, seq_length, d_model]\n        \"\"\"\n        batch_size, seq_length, _ = x.shape\n        h = torch.zeros(batch_size, self.d_state, device=x.device)\n        outputs = []\n        \n        # é€’å½’è®¡ç®—ï¼ˆç±»ä¼¼RNNï¼‰\n        for t in range(seq_length):\n            # çŠ¶æ€æ›´æ–°\n            h = torch.matmul(h, self.A) + self.B(x[:, t, :])\n            # è¾“å‡º\n            y_t = self.C(h)\n            outputs.append(y_t)\n        \n        output = torch.stack(outputs, dim=1)\n        return output\n\n# ä½¿ç”¨ç¤ºä¾‹\nif __name__ == \"__main__\":\n    model = SimpleSSM(d_model=512, d_state=16)\n    x = torch.randn(2, 100, 512)\n    output = model(x)\n    print(f\"è¾“å‡ºå½¢çŠ¶: {output.shape}\")  # [2, 100, 512]"
        }
      ]
    }
  ]
}