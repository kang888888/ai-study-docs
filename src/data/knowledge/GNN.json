{
  "title": "GNN (Graph Neural Network) å›¾ç¥ç»ç½‘ç»œ",
  "subtitle": "ä¸“é—¨å¤„ç†å›¾ç»“æ„æ•°æ®çš„ç¥ç»ç½‘ç»œ",
  "content": [
    {
      "type": "section",
      "title": "ğŸ“– æ ¸å¿ƒæ¦‚å¿µ",
      "content": [
        {
          "type": "desc-box",
          "content": [
            "ä¸“é—¨å¤„ç†å›¾ç»“æ„æ•°æ®ï¼ˆèŠ‚ç‚¹+è¾¹ï¼‰çš„ç¥ç»ç½‘ç»œã€‚é€šè¿‡æ¶ˆæ¯ä¼ é€’æœºåˆ¶ï¼ˆMessage Passingï¼‰ï¼Œè®©èŠ‚ç‚¹èšåˆé‚»å±…èŠ‚ç‚¹çš„ä¿¡æ¯ï¼Œå­¦ä¹ å›¾çš„è¡¨ç¤ºã€‚"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸŒŸ æ ¸å¿ƒç‰¹ç‚¹",
      "content": [
        {
          "type": "features",
          "items": [
            "æ¶ˆæ¯ä¼ é€’ï¼šèŠ‚ç‚¹ä»é‚»å±…èŠ‚ç‚¹èšåˆä¿¡æ¯ï¼Œæ›´æ–°è‡ªèº«è¡¨ç¤º",
            "æ’åˆ—ä¸å˜æ€§ï¼šå¯¹èŠ‚ç‚¹é¡ºåºä¸æ•æ„Ÿ",
            "å½’çº³å­¦ä¹ ï¼šå¯ä»¥æ³›åŒ–åˆ°è®­ç»ƒæ—¶æœªè§è¿‡çš„å›¾",
            "å¤šç§å˜ä½“ï¼šGCNã€GraphSAGEã€GATï¼ˆå›¾æ³¨æ„åŠ›ï¼‰",
            "éæ¬§å‡ é‡Œå¾—æ•°æ®ï¼šå¤„ç†ä¸è§„åˆ™ç»“æ„æ•°æ®"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "âš™ï¸ å…³é”®æŠ€æœ¯",
      "content": [
        {
          "type": "tech-box",
          "content": "æ¶ˆæ¯ä¼ é€’ï¼ˆMessage Passingï¼‰ã€èšåˆå‡½æ•°ï¼ˆAggregationï¼‰ã€å›¾æ³¨æ„åŠ›ï¼ˆGATï¼‰"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸš€ åº”ç”¨åœºæ™¯",
      "content": [
        {
          "type": "app-box",
          "content": "ç¤¾äº¤ç½‘ç»œåˆ†æã€åˆ†å­æ€§è´¨é¢„æµ‹ã€æ¨èç³»ç»Ÿã€çŸ¥è¯†å›¾è°±ã€äº¤é€šé¢„æµ‹"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“Š æ¶æ„å›¾è§£",
      "content": [
        {
          "type": "diagram-gallery",
          "images": [
            {
              "type": "svg-d3",
              "component": "GNNDiagram",
              "caption": "GNNå›¾ç»“æ„",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "GNNå›¾ç»“æ„",
                "data": null
              }
            },
            {
              "type": "svg-d3",
              "component": "GNNDiagram",
              "caption": "GNNæ¶ˆæ¯ä¼ é€’",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "GNNæ¶ˆæ¯ä¼ é€’",
                "data": null
              }
            },
            {
              "type": "svg-d3",
              "component": "GNNDiagram",
              "caption": "GNNå¤šå±‚ç»“æ„",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "GNNå¤šå±‚ç»“æ„",
                "data": null
              }
            },
            {
              "type": "svg-d3",
              "component": "GNNDiagram",
              "caption": "GATæ³¨æ„åŠ›æƒé‡",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "GATæ³¨æ„åŠ›æƒé‡",
                "data": null
              }
            },
            {
              "type": "svg-d3",
              "component": "GNNDiagram",
              "caption": "èŠ‚ç‚¹åµŒå…¥å­¦ä¹ ",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "èŠ‚ç‚¹åµŒå…¥å­¦ä¹ ",
                "data": null
              }
            },
            {
              "type": "svg-d3",
              "component": "GNNDiagram",
              "caption": "GNNå˜ä½“å¯¹æ¯”",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "GNNå˜ä½“å¯¹æ¯”",
                "data": null
              }
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“ æ•°å­¦åŸç†",
      "content": [
        {
          "type": "math-box",
          "title": "æ¶ˆæ¯ä¼ é€’æœºåˆ¶",
          "formulas": [
            {
              "text": "GNNçš„æ ¸å¿ƒæ˜¯æ¶ˆæ¯ä¼ é€’ï¼š"
            },
            {
              "display": "h_v^{(l+1)} = \\text{UPDATE}^{(l)}\\left(h_v^{(l)}, \\text{AGGREGATE}^{(l)}\\left(\\{h_u^{(l)} : u \\in \\mathcal{N}(v)\\}\\right)\\right)"
            },
            {
              "text": "å…¶ä¸­ï¼š"
            }
          ]
        },
        {
          "type": "math-box",
          "title": "å›¾å·ç§¯ç½‘ç»œï¼ˆGCNï¼‰",
          "formulas": [
            {
              "text": "GCNçš„æ›´æ–°å…¬å¼ï¼š"
            },
            {
              "display": "H^{(l+1)} = \\sigma\\left(\\tilde{D}^{-\\frac{1}{2}}\\tilde{A}\\tilde{D}^{-\\frac{1}{2}} H^{(l)} W^{(l)}\\right)"
            },
            {
              "text": "å…¶ä¸­ $\\tilde{A} = A + I$ æ˜¯å¸¦è‡ªç¯çš„é‚»æ¥çŸ©é˜µï¼Œ$\\tilde{D}$ æ˜¯åº¦çŸ©é˜µ",
              "inline": "\\tilde{A} = A + I"
            }
          ]
        },
        {
          "type": "math-box",
          "title": "å›¾æ³¨æ„åŠ›ç½‘ç»œï¼ˆGATï¼‰",
          "formulas": [
            {
              "text": "GATä½¿ç”¨æ³¨æ„åŠ›æœºåˆ¶ï¼š"
            },
            {
              "display": "\\alpha_{ij} = \\frac{\\exp(\\text{LeakyReLU}(a^T [Wh_i || Wh_j]))}{\\sum_{k \\in \\mathcal{N}(i)} \\exp(\\text{LeakyReLU}(a^T [Wh_i || Wh_k]))}"
            },
            {
              "display": "h_i^{(l+1)} = \\sigma\\left(\\sum_{j \\in \\mathcal{N}(i)} \\alpha_{ij} W^{(l)} h_j^{(l)}\\right)"
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ’» Python ä»£ç ç¤ºä¾‹",
      "content": [
        {
          "type": "code-box",
          "title": "ä½¿ç”¨ PyTorch Geometric å®ç° GCN",
          "language": "python",
          "code": "import torch\nimport torch.nn as nn\nimport torch.nn.functional as F\nfrom torch_geometric.nn import GCNConv\n\nclass GCN(nn.Module):\n    \"\"\"å›¾å·ç§¯ç½‘ç»œ\"\"\"\n    def __init__(self, num_features, hidden_dim, num_classes):\n        super(GCN, self).__init__()\n        self.conv1 = GCNConv(num_features, hidden_dim)\n        self.conv2 = GCNConv(hidden_dim, num_classes)\n        self.dropout = nn.Dropout(0.5)\n    \n    def forward(self, x, edge_index):\n        \"\"\"\n        å‚æ•°:\n            x: èŠ‚ç‚¹ç‰¹å¾ [num_nodes, num_features]\n            edge_index: è¾¹ç´¢å¼• [2, num_edges]\n        \"\"\"\n        x = self.conv1(x, edge_index)\n        x = F.relu(x)\n        x = self.dropout(x)\n        x = self.conv2(x, edge_index)\n        return F.log_softmax(x, dim=1)\n\n# ä½¿ç”¨ç¤ºä¾‹\nif __name__ == \"__main__\":\n    # åˆ›å»ºæ¨¡å‹\n    model = GCN(num_features=1433, hidden_dim=64, num_classes=7)\n    \n    # æ¨¡æ‹Ÿå›¾æ•°æ®\n    num_nodes = 2708\n    num_features = 1433\n    x = torch.randn(num_nodes, num_features)\n    edge_index = torch.randint(0, num_nodes, (2, 10556))\n    \n    # å‰å‘ä¼ æ’­\n    output = model(x, edge_index)\n    print(f\"è¾“å‡ºå½¢çŠ¶: {output.shape}\")  # [2708, 7]"
        },
        {
          "type": "code-box",
          "title": "æ‰‹åŠ¨å®ç°ç®€å•çš„ GNN å±‚",
          "language": "python",
          "code": "import torch\nimport torch.nn as nn\n\nclass SimpleGNNLayer(nn.Module):\n    \"\"\"ç®€å•çš„GNNå±‚\"\"\"\n    def __init__(self, in_dim, out_dim):\n        super(SimpleGNNLayer, self).__init__()\n        self.linear = nn.Linear(in_dim, out_dim)\n    \n    def forward(self, x, adj):\n        \"\"\"\n        å‚æ•°:\n            x: èŠ‚ç‚¹ç‰¹å¾ [num_nodes, in_dim]\n            adj: é‚»æ¥çŸ©é˜µ [num_nodes, num_nodes]\n        \"\"\"\n        # æ¶ˆæ¯ä¼ é€’ï¼šèšåˆé‚»å±…ä¿¡æ¯\n        support = self.linear(x)  # [num_nodes, out_dim]\n        output = torch.matmul(adj, support)  # [num_nodes, out_dim]\n        return output\n\n# ä½¿ç”¨ç¤ºä¾‹\nif __name__ == \"__main__\":\n    layer = SimpleGNNLayer(in_dim=64, out_dim=32)\n    x = torch.randn(100, 64)\n    adj = torch.randn(100, 100)\n    adj = (adj > 0).float()  # äºŒå€¼åŒ–é‚»æ¥çŸ©é˜µ\n    \n    output = layer(x, adj)\n    print(f\"è¾“å‡ºå½¢çŠ¶: {output.shape}\")  # [100, 32]"
        }
      ]
    }
  ]
}