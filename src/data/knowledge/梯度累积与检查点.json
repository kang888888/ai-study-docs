{
  "title": "æ¢¯åº¦ç´¯ç§¯ä¸æ£€æŸ¥ç‚¹ï¼ˆGradient Accumulation & Checkpointingï¼‰",
  "subtitle": "æ¢¯åº¦ç´¯ç§¯æ¨¡æ‹Ÿæ›´å¤§æ‰¹æ¬¡ï¼Œæ£€æŸ¥ç‚¹æŠ€æœ¯èŠ‚çœå†…å­˜ã€‚",
  "content": [
    {
      "type": "section",
      "title": "ğŸ“– æ ¸å¿ƒæ¦‚å¿µ",
      "content": [
        {
          "type": "desc-box",
          "content": [
            "æ¢¯åº¦ç´¯ç§¯é€šè¿‡å¤šæ¬¡å‰å‘ä¼ æ’­ç´¯ç§¯æ¢¯åº¦åå†æ›´æ–°å‚æ•°ï¼Œå…è®¸ä½¿ç”¨æ›´å¤§çš„æœ‰æ•ˆæ‰¹æ¬¡å¤§å°ï¼›æ£€æŸ¥ç‚¹æŠ€æœ¯é€šè¿‡åœ¨å‰å‘ä¼ æ’­æ—¶ä¸¢å¼ƒä¸­é—´æ¿€æ´»å€¼ï¼Œåœ¨åå‘ä¼ æ’­æ—¶é‡æ–°è®¡ç®—ï¼Œå¤§å¹…å‡å°‘å†…å­˜å ç”¨ã€‚"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸŒŸ æ ¸å¿ƒç‰¹ç‚¹",
      "content": [
        {
          "type": "features",
          "items": [
            "å†…å­˜ä¼˜åŒ–ï¼šæ£€æŸ¥ç‚¹æŠ€æœ¯å¯å‡å°‘50-80%çš„æ¿€æ´»å†…å­˜",
            "æ‰¹æ¬¡æ‰©å±•ï¼šæ¢¯åº¦ç´¯ç§¯å…è®¸ä½¿ç”¨æ›´å¤§çš„æœ‰æ•ˆæ‰¹æ¬¡å¤§å°",
            "è®¡ç®—æƒè¡¡ï¼šæ£€æŸ¥ç‚¹ä»¥è®¡ç®—æ—¶é—´æ¢å–å†…å­˜ç©ºé—´",
            "çµæ´»é…ç½®ï¼šå¯æ ¹æ®ç¡¬ä»¶èµ„æºè°ƒæ•´ç´¯ç§¯æ­¥æ•°å’Œæ£€æŸ¥ç‚¹é¢‘ç‡",
            "è®­ç»ƒç¨³å®šï¼šä¸å½±å“æœ€ç»ˆæ¨¡å‹æ€§èƒ½"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "âš™ï¸ å…³é”®æŠ€æœ¯",
      "content": [
        {
          "type": "tech-box",
          "content": "æ¢¯åº¦ç´¯ç§¯ã€æ¿€æ´»æ£€æŸ¥ç‚¹ã€æ¢¯åº¦æ£€æŸ¥ç‚¹ã€å†…å­˜ä¼˜åŒ–ã€æ‰¹æ¬¡æ‰©å±•"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸš€ åº”ç”¨åœºæ™¯",
      "content": [
        {
          "type": "app-box",
          "content": "å¤§æ¨¡å‹è®­ç»ƒã€å†…å­˜ä¼˜åŒ–ã€æ‰¹æ¬¡æ‰©å±•ã€é•¿åºåˆ—è®­ç»ƒã€èµ„æºå—é™ç¯å¢ƒ"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“Š æ¶æ„å›¾è§£",
      "content": [
        {
          "type": "diagram-gallery",
          "images": [
            {
              "type": "svg-d3",
              "component": "GenericDiagram",
              "caption": "æ¢¯åº¦ç´¯ç§¯åŸç†",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "æ¢¯åº¦ç´¯ç§¯åŸç†"
              }
            },
            {
              "type": "svg-d3",
              "component": "GenericDiagram",
              "caption": "æ¢¯åº¦æ£€æŸ¥ç‚¹åŸç†",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "æ¢¯åº¦æ£€æŸ¥ç‚¹åŸç†"
              }
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ’» ä»£ç ç¤ºä¾‹",
      "content": [
        {
          "type": "code-box",
          "title": "æ¢¯åº¦ç´¯ç§¯ç¤ºä¾‹",
          "language": "python",
          "code": "accumulation_steps = 4\noptimizer.zero_grad()\n\nfor i, batch in enumerate(dataloader):\n    outputs = model(batch)\n    loss = criterion(outputs, targets) / accumulation_steps\n    loss.backward()\n    \n    if (i + 1) % accumulation_steps == 0:\n        optimizer.step()\n        optimizer.zero_grad()"
        },
        {
          "type": "code-box",
          "title": "æ£€æŸ¥ç‚¹æŠ€æœ¯ç¤ºä¾‹",
          "language": "python",
          "code": "from torch.utils.checkpoint import checkpoint\n\n# å¯ç”¨æ£€æŸ¥ç‚¹\nmodel.gradient_checkpointing_enable()\n\n# æˆ–è‡ªå®šä¹‰æ£€æŸ¥ç‚¹\ndef forward_with_checkpoint(self, x):\n    x = checkpoint(self.layer1, x)\n    x = checkpoint(self.layer2, x)\n    return x"
        }
      ]
    }
  ]
}