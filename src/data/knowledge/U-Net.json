{
  "title": "U-Net",
  "subtitle": "ä¸“ä¸ºå›¾åƒåˆ†å‰²è®¾è®¡çš„ç¼–ç å™¨-è§£ç å™¨æ¶æ„",
  "content": [
    {
      "type": "section",
      "title": "ğŸ“– æ ¸å¿ƒæ¦‚å¿µ",
      "content": [
        {
          "type": "desc-box",
          "content": [
            "ä¸“ä¸ºåŒ»å­¦å›¾åƒåˆ†å‰²è®¾è®¡çš„ç¼–ç å™¨-è§£ç å™¨æ¶æ„ã€‚é€šè¿‡å¯¹ç§°çš„Uå‹ç»“æ„å’Œè·³è·ƒè¿æ¥ï¼ˆSkip Connectionï¼‰ï¼Œå°†ç¼–ç å™¨çš„é«˜åˆ†è¾¨ç‡ç‰¹å¾ç›´æ¥ä¼ é€’ç»™è§£ç å™¨ï¼Œä¿ç•™ç»†èŠ‚ä¿¡æ¯ã€‚"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸŒŸ æ ¸å¿ƒç‰¹ç‚¹",
      "content": [
        {
          "type": "features",
          "items": [
            "Uå‹å¯¹ç§°ç»“æ„ï¼šç¼–ç å™¨ä¸‹é‡‡æ ·ï¼Œè§£ç å™¨ä¸Šé‡‡æ ·",
            "è·³è·ƒè¿æ¥ï¼šå°†ç¼–ç å™¨ç‰¹å¾æ‹¼æ¥åˆ°è§£ç å™¨ï¼Œä¿ç•™ç©ºé—´ç»†èŠ‚",
            "å°‘æ ·æœ¬é«˜æ•ˆï¼šåœ¨å°æ•°æ®é›†ä¸Šä¹Ÿèƒ½è®­ç»ƒå‡ºå¥½æ•ˆæœ",
            "åƒç´ çº§é¢„æµ‹ï¼šè¾“å‡ºä¸è¾“å…¥åŒå°ºå¯¸çš„åˆ†å‰²å›¾",
            "å¹¿æ³›åº”ç”¨ï¼šæˆä¸ºå›¾åƒåˆ†å‰²çš„æ ‡å‡†æ¶æ„"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "âš™ï¸ å…³é”®æŠ€æœ¯",
      "content": [
        {
          "type": "tech-box",
          "content": "ç¼–ç å™¨-è§£ç å™¨ã€è·³è·ƒè¿æ¥ï¼ˆConcatenationï¼‰ã€ä¸Šé‡‡æ ·ï¼ˆTransposed Convolutionï¼‰"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸš€ åº”ç”¨åœºæ™¯",
      "content": [
        {
          "type": "app-box",
          "content": "åŒ»å­¦å½±åƒåˆ†å‰²ã€è¯­ä¹‰åˆ†å‰²ã€å®ä¾‹åˆ†å‰²ã€Diffusionæ¨¡å‹çš„å»å™ªç½‘ç»œ"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“Š æ¶æ„å›¾è§£",
      "content": [
        {
          "type": "diagram-gallery",
          "images": [
            {
              "type": "svg-d3",
              "component": "UNetDiagram",
              "caption": "U-Netæ¶æ„å›¾",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "U-Netæ¶æ„å›¾",
                "data": null
              }
            },
            {
              "type": "svg-d3",
              "component": "UNetDiagram",
              "caption": "U-Netè·³è·ƒè¿æ¥",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "U-Netè·³è·ƒè¿æ¥",
                "data": null
              }
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“ æ•°å­¦åŸç†",
      "content": [
        {
          "type": "math-box",
          "title": "ç¼–ç å™¨-è§£ç å™¨ç»“æ„",
          "formulas": [
            {
              "text": "ç¼–ç å™¨ï¼ˆä¸‹é‡‡æ ·ï¼‰ï¼š"
            },
            {
              "display": "f_i = \\text{MaxPool}(\\text{ReLU}(\\text{Conv}(f_{i-1})))"
            },
            {
              "text": "è§£ç å™¨ï¼ˆä¸Šé‡‡æ ·ï¼‰ï¼š"
            },
            {
              "display": "g_i = \\text{ReLU}(\\text{Conv}(\\text{Concat}(\\text{Upsample}(g_{i-1}), f_{n-i})))"
            },
            {
              "text": "å…¶ä¸­ $f_{n-i}$ æ˜¯ç¼–ç å™¨å¯¹åº”å±‚çš„ç‰¹å¾ï¼Œé€šè¿‡è·³è·ƒè¿æ¥ä¼ é€’",
              "inline": "f_{n-i}"
            }
          ]
        },
        {
          "type": "math-box",
          "title": "è·³è·ƒè¿æ¥",
          "formulas": [
            {
              "text": "å°†ç¼–ç å™¨ç‰¹å¾ä¸è§£ç å™¨ç‰¹å¾æ‹¼æ¥ï¼š"
            },
            {
              "display": "g_i = \\text{Concat}(\\text{Upsample}(g_{i-1}), f_{n-i})"
            },
            {
              "text": "è¿™æ ·å¯ä»¥ä¿ç•™é«˜åˆ†è¾¨ç‡çš„ç©ºé—´ä¿¡æ¯ï¼Œæé«˜åˆ†å‰²ç²¾åº¦"
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ’» Python ä»£ç ç¤ºä¾‹",
      "content": [
        {
          "type": "code-box",
          "title": "ä½¿ç”¨ PyTorch å®ç° U-Net",
          "language": "python",
          "code": "import torch\nimport torch.nn as nn\nimport torch.nn.functional as F\n\nclass DoubleConv(nn.Module):\n    \"\"\"åŒå·ç§¯å—\"\"\"\n    def __init__(self, in_channels, out_channels):\n        super(DoubleConv, self).__init__()\n        self.conv = nn.Sequential(\n            nn.Conv2d(in_channels, out_channels, 3, padding=1),\n            nn.BatchNorm2d(out_channels),\n            nn.ReLU(inplace=True),\n            nn.Conv2d(out_channels, out_channels, 3, padding=1),\n            nn.BatchNorm2d(out_channels),\n            nn.ReLU(inplace=True)\n        )\n    \n    def forward(self, x):\n        return self.conv(x)\n\nclass UNet(nn.Module):\n    \"\"\"U-Net æ¨¡å‹\"\"\"\n    def __init__(self, in_channels=3, num_classes=1):\n        super(UNet, self).__init__()\n        \n        # ç¼–ç å™¨ï¼ˆä¸‹é‡‡æ ·è·¯å¾„ï¼‰\n        self.enc1 = DoubleConv(in_channels, 64)\n        self.enc2 = DoubleConv(64, 128)\n        self.enc3 = DoubleConv(128, 256)\n        self.enc4 = DoubleConv(256, 512)\n        \n        self.pool = nn.MaxPool2d(2)\n        \n        # ç“¶é¢ˆå±‚\n        self.bottleneck = DoubleConv(512, 1024)\n        \n        # è§£ç å™¨ï¼ˆä¸Šé‡‡æ ·è·¯å¾„ï¼‰\n        self.up4 = nn.ConvTranspose2d(1024, 512, 2, stride=2)\n        self.dec4 = DoubleConv(1024, 512)\n        \n        self.up3 = nn.ConvTranspose2d(512, 256, 2, stride=2)\n        self.dec3 = DoubleConv(512, 256)\n        \n        self.up2 = nn.ConvTranspose2d(256, 128, 2, stride=2)\n        self.dec2 = DoubleConv(256, 128)\n        \n        self.up1 = nn.ConvTranspose2d(128, 64, 2, stride=2)\n        self.dec1 = DoubleConv(128, 64)\n        \n        # è¾“å‡ºå±‚\n        self.final = nn.Conv2d(64, num_classes, 1)\n    \n    def forward(self, x):\n        # ç¼–ç å™¨\n        e1 = self.enc1(x)\n        e2 = self.enc2(self.pool(e1))\n        e3 = self.enc3(self.pool(e2))\n        e4 = self.enc4(self.pool(e3))\n        \n        # ç“¶é¢ˆå±‚\n        b = self.bottleneck(self.pool(e4))\n        \n        # è§£ç å™¨ï¼ˆå¸¦è·³è·ƒè¿æ¥ï¼‰\n        d4 = self.up4(b)\n        d4 = torch.cat([d4, e4], dim=1)\n        d4 = self.dec4(d4)\n        \n        d3 = self.up3(d4)\n        d3 = torch.cat([d3, e3], dim=1)\n        d3 = self.dec3(d3)\n        \n        d2 = self.up2(d3)\n        d2 = torch.cat([d2, e2], dim=1)\n        d2 = self.dec2(d2)\n        \n        d1 = self.up1(d2)\n        d1 = torch.cat([d1, e1], dim=1)\n        d1 = self.dec1(d1)\n        \n        # è¾“å‡º\n        out = self.final(d1)\n        \n        return out\n\n# ä½¿ç”¨ç¤ºä¾‹\nif __name__ == \"__main__\":\n    model = UNet(in_channels=3, num_classes=1)\n    \n    # æ¨¡æ‹Ÿè¾“å…¥ (batch_size=4, channels=3, height=572, width=572)\n    x = torch.randn(4, 3, 572, 572)\n    \n    # å‰å‘ä¼ æ’­\n    output = model(x)\n    print(f\"è¾“å‡ºå½¢çŠ¶: {output.shape}\")  # [4, 1, 572, 572]"
        }
      ]
    }
  ]
}