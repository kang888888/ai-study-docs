{
  "title": "SmoothQuantï¼šå¹³æ»‘æ¿€æ´»çš„è”åˆé‡åŒ–",
  "subtitle": "é€šè¿‡åœ¨æ¨ç†å‰å°†å¤§å¹…åº¦æ¿€æ´»è¿ç§»åˆ°æƒé‡ä¸­ï¼Œå®ç°æ¿€æ´»/æƒé‡é‡åŒ–çš„ååŒä¼˜åŒ–ï¼Œæ˜¾è‘—é™ä½ outlier çš„å½±å“ã€‚",
  "content": [
    {
      "type": "section",
      "title": "ğŸ“Š å›¾è§£",
      "content": [
        {
          "type": "diagram-gallery",
          "images": [
            {
              "type": "svg-d3",
              "component": "GenericDiagram",
              "caption": "å¹³æ»‘æµç¨‹",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "flow",
                "title": "å¹³æ»‘æµç¨‹"
              }
            },
            {
              "type": "svg-d3",
              "component": "GenericDiagram",
              "caption": "æ¿€æ´»åˆ†å¸ƒå˜åŒ–",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "æ¿€æ´»åˆ†å¸ƒå˜åŒ–"
              }
            },
            {
              "type": "svg-d3",
              "component": "GenericDiagram",
              "caption": "çŸ©é˜µé‡ç¼©æ”¾",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "çŸ©é˜µé‡ç¼©æ”¾"
              }
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“ æ•°å­¦åŸç†",
      "content": [
        {
          "type": "math-box",
          "title": "å¹³æ»‘å˜æ¢",
          "formulas": [
            {
              "display": "W' = W D^{-1}, \\quad A' = D A"
            },
            {
              "text": "$D = \\text{diag}(\\alpha_1, ..., \\alpha_n)$ï¼Œä½¿å¾— $\\max(|A'|)$ æ›´å°ã€‚",
              "inline": "D = \\text{diag}(\\alpha_1, ..., \\alpha_n)"
            }
          ]
        },
        {
          "type": "math-box",
          "title": "é€‰æ‹© $\\alpha$",
          "formulas": [
            {
              "display": "\\alpha_i = \\arg\\min_{\\alpha \\in [0,1]} \\left( \\lambda \\cdot \\|A_i \\alpha\\|_{\\infty} + (1-\\lambda) \\cdot \\|W_i / \\alpha\\|_{\\infty} \\right)"
            },
            {
              "text": "åœ¨å®è·µä¸­é€šå¸¸é€šè¿‡ç½‘æ ¼æœç´¢æˆ–è´ªå¿ƒè¿‘ä¼¼ã€‚"
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ’» ä»£ç ç¤ºä¾‹",
      "content": [
        {
          "type": "code-box",
          "title": "åœ¨ TensorRT-LLM ä¸­å¯ç”¨ SmoothQuant",
          "language": "python",
          "code": "from tensorrt_llm.quantization import smooth_quantize\n\nengine = smooth_quantize(\n    onnx_path=\"llama2.onnx\",\n    calib_data=\"calib_texts.txt\",\n    act_bits=8,\n    weight_bits=8,\n    alpha=0.5,\n    per_channel=True\n)\nengine.save(\"./llama2_smoothquant.plan\")"
        }
      ]
    }
  ]
}