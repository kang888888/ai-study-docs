{
  "title": "vLLMï¼šåŸºäº PagedAttention çš„é«˜ååæ¨ç†å¼•æ“",
  "subtitle": "é€šè¿‡åˆ†é¡µ KV Cache + å¹¶è¡Œè°ƒåº¦å™¨ï¼Œåœ¨å•å¡ä¸Šå³å¯å®ç°æ•°åƒ token/s çš„ç”Ÿæˆèƒ½åŠ›ã€‚",
  "content": [
    {
      "type": "section",
      "title": "ğŸ“– æ ¸å¿ƒæ¦‚å¿µ",
      "content": [
        {
          "type": "desc-box",
          "content": [
            "vLLMæ˜¯é«˜æ€§èƒ½LLMæ¨ç†å’ŒæœåŠ¡æ¡†æ¶ï¼Œé€šè¿‡PagedAttentionã€è¿ç»­æ‰¹å¤„ç†ç­‰æŠ€æœ¯å®ç°é«˜ååé‡å’Œä½å»¶è¿Ÿçš„æ¨ç†æœåŠ¡ã€‚"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸŒŸ æ ¸å¿ƒç‰¹ç‚¹",
      "content": [
        {
          "type": "features",
          "items": [
            "é«˜ååé‡ï¼šPagedAttentionå®ç°é«˜æ•ˆæœåŠ¡",
            "è¿ç»­æ‰¹å¤„ç†ï¼šåŠ¨æ€æ‰¹å¤„ç†æé«˜åˆ©ç”¨ç‡",
            "ä½å»¶è¿Ÿï¼šä¼˜åŒ–çš„å†…å­˜ç®¡ç†",
            "æ˜“äºéƒ¨ç½²ï¼šç®€å•çš„APIæ¥å£",
            "å¼€æºå…è´¹ï¼šç¤¾åŒºæ´»è·ƒ"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "âš™ï¸ å…³é”®æŠ€æœ¯",
      "content": [
        {
          "type": "tech-box",
          "content": "PagedAttentionã€è¿ç»­æ‰¹å¤„ç†ã€å†…å­˜ç®¡ç†ã€è°ƒåº¦ä¼˜åŒ–ã€æœåŠ¡æ¡†æ¶"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸš€ åº”ç”¨åœºæ™¯",
      "content": [
        {
          "type": "app-box",
          "content": "LLMæœåŠ¡ã€APIæœåŠ¡ã€é«˜ååæ¨ç†ã€æ‰¹é‡æœåŠ¡ã€ç”Ÿäº§éƒ¨ç½²"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“Š å›¾è§£",
      "content": [
        {
          "type": "diagram-gallery",
          "images": [
            {
              "type": "svg-d3",
              "component": "GenericDiagram",
              "caption": "æ¶æ„",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "æ¶æ„"
              }
            },
            {
              "type": "svg-d3",
              "component": "GenericDiagram",
              "caption": "PagedAttention",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "flow",
                "title": "PagedAttention"
              }
            },
            {
              "type": "svg-d3",
              "component": "GenericDiagram",
              "caption": "è°ƒåº¦å™¨",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "è°ƒåº¦å™¨"
              }
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“ æ•°å­¦/æ€§èƒ½æ¨¡å‹",
      "content": [
        {
          "type": "math-box",
          "title": "ååä¸Šç•Œ",
          "formulas": [
            {
              "display": "TPS \\approx \\frac{B_{eff} \\times d_{model} \\times H}{\\text{latency}_{\\text{step}}}"
            },
            {
              "text": "vLLM é€šè¿‡æå‡æœ‰æ•ˆæ‰¹æ¬¡ $B_{eff}$ ä¸é™ä½ step å»¶è¿Ÿæ¥é€¼è¿‘ä¸Šç•Œã€‚",
              "inline": "B_{eff}"
            }
          ]
        },
        {
          "type": "math-box",
          "title": "åˆ†é¡µå‘½ä¸­ç‡",
          "formulas": [
            {
              "display": "\\text{HitRate} = 1 - \\frac{\\text{page\\_faults}}{\\text{total\\_access}}"
            },
            {
              "text": "è¿ç»­æ‰¹å¤„ç†èƒ½æé«˜å‘½ä¸­ç‡ï¼Œä»è€Œç¨³å®šå»¶è¿Ÿã€‚"
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ’» ä»£ç ç¤ºä¾‹",
      "content": [
        {
          "type": "code-box",
          "title": "å¯åŠ¨ REST Server",
          "language": "bash",
          "code": "pip install vllm\npython -m vllm.entrypoints.openai.api_server \\\n  --model meta-llama/Llama-3-8b-Instruct \\\n  --gpu-memory-utilization 0.9 \\\n  --port 8000"
        }
      ]
    }
  ]
}