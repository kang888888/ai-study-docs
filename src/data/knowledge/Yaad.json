{
  "title": "Yaad",
  "subtitle": "åŸºäºMirasæ¡†æ¶çš„ä¼˜åŒ–æ³¨æ„åŠ›åå·®æ¨¡å‹",
  "content": [
    {
      "type": "section",
      "title": "ğŸ“– æ ¸å¿ƒæ¦‚å¿µ",
      "content": [
        {
          "type": "desc-box",
          "content": [
            "Yaad æ˜¯åŸºäº Miras æ¡†æ¶æå‡ºçš„ä¼˜åŒ–æ³¨æ„åŠ›åå·®æ¨¡å‹ï¼Œä¸“æ³¨äºæ›´å¥½çš„ä¿¡æ¯é€‰æ‹©å’Œç²¾ç¡®æ£€ç´¢ã€‚Yaad é€šè¿‡å­¦ä¹ æœ€ä¼˜çš„æ³¨æ„åŠ›åå·®æ¨¡å¼ï¼Œèƒ½å¤Ÿç²¾ç¡®è¿‡æ»¤å™ªå£°ï¼Œæé«˜æ£€ç´¢ç²¾åº¦ï¼Œé€‚ç”¨äºéœ€è¦ç²¾ç¡®æ£€ç´¢çš„ä»»åŠ¡ã€‚"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸŒŸ æ ¸å¿ƒç‰¹ç‚¹",
      "content": [
        {
          "type": "features",
          "items": [
            "**ä¼˜åŒ–çš„æ³¨æ„åŠ›åå·®**ï¼šå­¦ä¹ æœ€ä¼˜çš„åå·®æ¨¡å¼ï¼Œç²¾ç¡®æ§åˆ¶ä¿¡æ¯å…³æ³¨",
            "**æ›´å¥½çš„ä¿¡æ¯é€‰æ‹©**ï¼šæ™ºèƒ½è¿‡æ»¤ä¸ç›¸å…³ä¿¡æ¯ï¼Œæé«˜æ£€ç´¢è´¨é‡",
            "**ç²¾ç¡®æ£€ç´¢**ï¼šé€šè¿‡ä¼˜åŒ–çš„åå·®å®ç°é«˜ç²¾åº¦ä¿¡æ¯æ£€ç´¢",
            "**å‡å°‘å™ªå£°å¹²æ‰°**ï¼šæœ‰æ•ˆé™ä½ä¸ç›¸å…³è®°å¿†çš„æƒé‡ï¼Œæé«˜æ£€ç´¢ç²¾åº¦"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "âš™ï¸ æŠ€æœ¯æ¶æ„",
      "content": [
        {
          "type": "tech-box",
          "content": "æ³¨æ„åŠ›åå·®å­¦ä¹ ï¼šé€šè¿‡è®­ç»ƒå­¦ä¹ æœ€ä¼˜çš„æ³¨æ„åŠ›åå·®æ¨¡å¼ï¼Œæœ€å¤§åŒ–ç›¸å…³æ€§ï¼Œæœ€å°åŒ–å†—ä½™"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“ æ•°å­¦åŸç†",
      "content": [
        {
          "type": "math-box",
          "title": "ä¼˜åŒ–çš„æ³¨æ„åŠ›åå·®",
          "formulas": [
            {
              "text": "Yaad çš„æ³¨æ„åŠ›æƒé‡è®¡ç®—ï¼š"
            },
            {
              "display": "\\alpha_i = \\text{softmax}(\\text{score}(q, k_i) + \\text{bias}_i(\\theta))"
            },
            {
              "text": "å…¶ä¸­ $\\text{bias}_i(\\theta)$ æ˜¯å¯å­¦ä¹ çš„åå·®å‡½æ•°ï¼Œé€šè¿‡è®­ç»ƒä¼˜åŒ–ï¼š",
              "inline": "\\text{bias}_i(\\theta)"
            },
            {
              "display": "\\theta^* = \\arg\\min_\\theta \\mathcal{L}(\\text{retrieval}, \\text{ground\\_truth})"
            },
            {
              "text": "ä¼˜åŒ–çš„ç›®æ ‡æ˜¯ï¼š"
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸš€ åº”ç”¨åœºæ™¯",
      "content": [
        {
          "type": "app-box",
          "content": "ç²¾ç¡®æ£€ç´¢ä»»åŠ¡ï¼šéœ€è¦é«˜ç²¾åº¦ä¿¡æ¯æ£€ç´¢çš„åœºæ™¯\n                    ä¿¡æ¯æ£€ç´¢ç³»ç»Ÿï¼šæœç´¢å¼•æ“ã€æ¨èç³»ç»Ÿç­‰éœ€è¦ç²¾ç¡®åŒ¹é…çš„åº”ç”¨\n                    çŸ¥è¯†é—®ç­”ï¼šéœ€è¦ä»å¤§é‡çŸ¥è¯†ä¸­ç²¾ç¡®æ£€ç´¢ç­”æ¡ˆçš„ä»»åŠ¡\n                    é«˜å¬å›ç‡ä»»åŠ¡ï¼šéœ€è¦ç²¾ç¡®æ£€ç´¢ä¸”å‡å°‘è¯¯æ£€çš„ä»»åŠ¡"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“Š æ¶æ„å›¾è§£",
      "content": [
        {
          "type": "diagram-gallery",
          "images": [
            {
              "type": "svg-d3",
              "component": "GenericDiagram",
              "caption": "Yaadæ¶æ„å›¾",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "Yaadæ¶æ„å›¾",
                "data": null
              }
            },
            {
              "type": "svg-d3",
              "component": "GenericDiagram",
              "caption": "Yaadç»„ä»¶è¯¦è§£",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "Yaadç»„ä»¶è¯¦è§£",
                "data": null
              }
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ’» Python ä»£ç ç¤ºä¾‹",
      "content": [
        {
          "type": "code-box",
          "title": "Yaad ä¼˜åŒ–æ³¨æ„åŠ›åå·®æ¨¡å—",
          "language": "python",
          "code": "import torch\nimport torch.nn as nn\nimport torch.nn.functional as F\n\nclass YaadAttentionBias(nn.Module):\n    \"\"\"Yaad ä¼˜åŒ–çš„æ³¨æ„åŠ›åå·®æ¨¡å—\"\"\"\n    def __init__(self, d_model, memory_size):\n        super(YaadAttentionBias, self).__init__()\n        self.d_model = d_model\n        self.memory_size = memory_size\n        \n        # è®°å¿†å­˜å‚¨\n        self.memory = nn.Parameter(torch.randn(memory_size, d_model))\n        \n        # å¯å­¦ä¹ çš„åå·®ç½‘ç»œ\n        self.bias_network = nn.Sequential(\n            nn.Linear(d_model, d_model // 2),\n            nn.ReLU(),\n            nn.Linear(d_model // 2, memory_size)\n        )\n        \n        # æŸ¥è¯¢å’Œé”®å€¼æŠ•å½±\n        self.query_proj = nn.Linear(d_model, d_model)\n        self.key_proj = nn.Linear(d_model, d_model)\n        self.value_proj = nn.Linear(d_model, d_model)\n    \n    def forward(self, query):\n        \"\"\"\n        ä½¿ç”¨ä¼˜åŒ–çš„æ³¨æ„åŠ›åå·®è¿›è¡Œæ£€ç´¢\n        å‚æ•°:\n            query: [batch_size, d_model] æŸ¥è¯¢å‘é‡\n        è¿”å›:\n            output: [batch_size, d_model] æ£€ç´¢ç»“æœ\n            attention: [batch_size, memory_size] æ³¨æ„åŠ›æƒé‡\n        \"\"\"\n        batch_size = query.shape[0]\n        \n        # è®¡ç®—æŸ¥è¯¢ã€é”®ã€å€¼\n        q = self.query_proj(query)\n        k = self.key_proj(self.memory)\n        v = self.value_proj(self.memory)\n        \n        # è®¡ç®—åŸºç¡€ç›¸ä¼¼åº¦\n        scores = torch.matmul(q, k.t()) / (self.d_model ** 0.5)\n        \n        # å­¦ä¹ æœ€ä¼˜çš„æ³¨æ„åŠ›åå·®\n        learned_bias = self.bias_network(query)  # [batch_size, memory_size]\n        \n        # åº”ç”¨ä¼˜åŒ–çš„åå·®\n        scores = scores + learned_bias\n        \n        # è®¡ç®—æ³¨æ„åŠ›æƒé‡\n        attention = F.softmax(scores, dim=-1)\n        \n        # åŠ æƒæ±‚å’Œ\n        output = torch.matmul(attention, v)\n        \n        return output, attention\n\n# ä½¿ç”¨ç¤ºä¾‹\nif __name__ == \"__main__\":\n    yaad = YaadAttentionBias(d_model=512, memory_size=1000)\n    query = torch.randn(2, 512)\n    \n    output, attention = yaad(query)\n    print(f\"è¾“å‡ºå½¢çŠ¶: {output.shape}\")  # [2, 512]\n    print(f\"æ³¨æ„åŠ›æƒé‡å½¢çŠ¶: {attention.shape}\")  # [2, 1000]\n    print(f\"æ³¨æ„åŠ›æƒé‡å’Œ: {attention.sum(dim=-1)}\")  # åº”è¯¥æ¥è¿‘1.0"
        }
      ]
    }
  ]
}