{
  "title": "GRU (Gated Recurrent Unit) é—¨æ§å¾ªç¯å•å…ƒ",
  "subtitle": "LSTMçš„ç®€åŒ–ç‰ˆæœ¬ï¼Œæ€§èƒ½ç›¸è¿‘ä½†æ›´é«˜æ•ˆ",
  "content": [
    {
      "type": "section",
      "title": "ğŸ“– æ ¸å¿ƒæ¦‚å¿µ",
      "content": [
        {
          "type": "desc-box",
          "content": [
            "LSTMçš„ç®€åŒ–ç‰ˆæœ¬ï¼Œå°†é—å¿˜é—¨å’Œè¾“å…¥é—¨åˆå¹¶ä¸ºæ›´æ–°é—¨ï¼Œå‡å°‘äº†å‚æ•°é‡ã€‚åœ¨å¾ˆå¤šä»»åŠ¡ä¸Šæ€§èƒ½æ¥è¿‘LSTMï¼Œä½†è®­ç»ƒé€Ÿåº¦æ›´å¿«ã€‚"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸŒŸ æ ¸å¿ƒç‰¹ç‚¹",
      "content": [
        {
          "type": "features",
          "items": [
            "ç®€åŒ–ç»“æ„ï¼šåªæœ‰ä¸¤ä¸ªé—¨ï¼ˆé‡ç½®é—¨ã€æ›´æ–°é—¨ï¼‰",
            "å‚æ•°æ›´å°‘ï¼šç›¸æ¯”LSTMå‡å°‘çº¦25%å‚æ•°",
            "è®¡ç®—æ›´å¿«ï¼šå‰å‘å’Œåå‘ä¼ æ’­é€Ÿåº¦æ›´å¿«",
            "æ€§èƒ½ç›¸è¿‘ï¼šåœ¨å¤šæ•°ä»»åŠ¡ä¸Šä¸LSTMæ€§èƒ½ç›¸å½“",
            "æ˜“äºè°ƒå‚ï¼šè¶…å‚æ•°æ›´å°‘ï¼Œæ›´å®¹æ˜“è°ƒä¼˜"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "âš™ï¸ å…³é”®æŠ€æœ¯",
      "content": [
        {
          "type": "tech-box",
          "content": "æ›´æ–°é—¨ã€é‡ç½®é—¨ã€å€™é€‰éšè—çŠ¶æ€"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸš€ åº”ç”¨åœºæ™¯",
      "content": [
        {
          "type": "app-box",
          "content": "åºåˆ—å»ºæ¨¡ã€æ—¶é—´åºåˆ—é¢„æµ‹ã€NLPä»»åŠ¡ã€è¯­éŸ³è¯†åˆ«"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“Š æ¶æ„å›¾è§£",
      "content": [
        {
          "type": "diagram-gallery",
          "images": [
            {
              "type": "svg-d3",
              "component": "GRUDiagram",
              "caption": "GRUå•å…ƒç»“æ„",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "GRUå•å…ƒç»“æ„",
                "data": null
              }
            },
            {
              "type": "svg-d3",
              "component": "GRUDiagram",
              "caption": "GRUåºåˆ—å±•å¼€",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "GRUåºåˆ—å±•å¼€",
                "data": null
              }
            },
            {
              "type": "svg-d3",
              "component": "GRUDiagram",
              "caption": "GRU vs LSTMå¯¹æ¯”",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "GRU vs LSTMå¯¹æ¯”",
                "data": null
              }
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“ æ•°å­¦åŸç†",
      "content": [
        {
          "type": "math-box",
          "title": "GRU æ ¸å¿ƒå…¬å¼",
          "formulas": [
            {
              "text": "åœ¨æ—¶é—´æ­¥ $t$ï¼ŒGRU çš„è®¡ç®—è¿‡ç¨‹ï¼š",
              "inline": "t"
            },
            {
              "text": "é‡ç½®é—¨ï¼ˆReset Gateï¼‰ï¼š"
            },
            {
              "display": "r_t = \\sigma(W_r \\cdot [h_{t-1}, x_t])"
            },
            {
              "text": "æ›´æ–°é—¨ï¼ˆUpdate Gateï¼‰ï¼š"
            },
            {
              "display": "z_t = \\sigma(W_z \\cdot [h_{t-1}, x_t])"
            },
            {
              "text": "å€™é€‰éšè—çŠ¶æ€ï¼š"
            },
            {
              "display": "\\tilde{h}_t = \\tanh(W \\cdot [r_t * h_{t-1}, x_t])"
            },
            {
              "text": "éšè—çŠ¶æ€æ›´æ–°ï¼š"
            },
            {
              "display": "h_t = (1 - z_t) * h_{t-1} + z_t * \\tilde{h}_t"
            },
            {
              "text": "å…¶ä¸­ $*$ è¡¨ç¤ºé€å…ƒç´ ç›¸ä¹˜ï¼Œ$\\sigma$ æ˜¯ sigmoid å‡½æ•°",
              "inline": "*"
            }
          ]
        },
        {
          "type": "math-box",
          "title": "ä¸ LSTM çš„åŒºåˆ«",
          "formulas": [
            {
              "text": "GRU å°† LSTM çš„é—å¿˜é—¨å’Œè¾“å…¥é—¨åˆå¹¶ä¸ºæ›´æ–°é—¨ï¼š"
            },
            {
              "display": "z_t = \\sigma(W_z \\cdot [h_{t-1}, x_t])"
            },
            {
              "text": "æ›´æ–°é—¨ $z_t$ åŒæ—¶æ§åˆ¶é—å¿˜å’Œè¾“å…¥ï¼š",
              "inline": "z_t"
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ’» Python ä»£ç ç¤ºä¾‹",
      "content": [
        {
          "type": "code-box",
          "title": "ä½¿ç”¨ PyTorch å®ç° GRU",
          "language": "python",
          "code": "import torch\nimport torch.nn as nn\n\nclass GRUCell(nn.Module):\n    \"\"\"æ‰‹åŠ¨å®ç° GRU å•å…ƒ\"\"\"\n    def __init__(self, input_size, hidden_size):\n        super(GRUCell, self).__init__()\n        self.hidden_size = hidden_size\n        \n        # é‡ç½®é—¨\n        self.W_r = nn.Linear(input_size + hidden_size, hidden_size)\n        \n        # æ›´æ–°é—¨\n        self.W_z = nn.Linear(input_size + hidden_size, hidden_size)\n        \n        # å€™é€‰éšè—çŠ¶æ€\n        self.W_h = nn.Linear(input_size + hidden_size, hidden_size)\n    \n    def forward(self, x, h_prev):\n        \"\"\"\n        å‰å‘ä¼ æ’­\n        \n        å‚æ•°:\n            x: å½“å‰è¾“å…¥ (batch_size, input_size)\n            h_prev: å‰ä¸€ä¸ªéšè—çŠ¶æ€ (batch_size, hidden_size)\n        \"\"\"\n        # æ‹¼æ¥è¾“å…¥å’Œéšè—çŠ¶æ€\n        combined = torch.cat([x, h_prev], dim=1)\n        \n        # é‡ç½®é—¨\n        r_t = torch.sigmoid(self.W_r(combined))\n        \n        # æ›´æ–°é—¨\n        z_t = torch.sigmoid(self.W_z(combined))\n        \n        # å€™é€‰éšè—çŠ¶æ€\n        combined_reset = torch.cat([x, r_t * h_prev], dim=1)\n        h_tilde = torch.tanh(self.W_h(combined_reset))\n        \n        # æ›´æ–°éšè—çŠ¶æ€\n        h_t = (1 - z_t) * h_prev + z_t * h_tilde\n        \n        return h_t\n\nclass GRU_Model(nn.Module):\n    \"\"\"ä½¿ç”¨ PyTorch å†…ç½® GRU\"\"\"\n    def __init__(self, input_size, hidden_size, num_layers, num_classes):\n        super(GRU_Model, self).__init__()\n        self.hidden_size = hidden_size\n        self.num_layers = num_layers\n        \n        # GRU å±‚\n        self.gru = nn.GRU(input_size, hidden_size, num_layers,\n                         batch_first=True, dropout=0.2)\n        \n        # å…¨è¿æ¥å±‚\n        self.fc = nn.Linear(hidden_size, num_classes)\n    \n    def forward(self, x):\n        # x shape: (batch_size, seq_length, input_size)\n        # åˆå§‹åŒ–éšè—çŠ¶æ€\n        h0 = torch.zeros(self.num_layers, x.size(0), self.hidden_size).to(x.device)\n        \n        # GRU å‰å‘ä¼ æ’­\n        out, h_n = self.gru(x, h0)\n        \n        # ä½¿ç”¨æœ€åä¸€ä¸ªæ—¶é—´æ­¥çš„è¾“å‡º\n        out = self.fc(out[:, -1, :])\n        \n        return out\n\n# ä½¿ç”¨ç¤ºä¾‹\nif __name__ == \"__main__\":\n    # ä½¿ç”¨ PyTorch å†…ç½® GRU\n    model = GRU_Model(input_size=128, hidden_size=256, \n                     num_layers=2, num_classes=10)\n    \n    # æ¨¡æ‹Ÿè¾“å…¥ (batch_size=32, seq_length=50, input_size=128)\n    x = torch.randn(32, 50, 128)\n    \n    # å‰å‘ä¼ æ’­\n    output = model(x)\n    print(f\"è¾“å‡ºå½¢çŠ¶: {output.shape}\")  # [32, 10]\n    \n    # æ‰‹åŠ¨å®ç° GRU Cell\n    gru_cell = GRUCell(input_size=128, hidden_size=256)\n    \n    # åˆå§‹åŒ–çŠ¶æ€\n    h = torch.zeros(32, 256)\n    \n    # å¤„ç†åºåˆ—\n    for t in range(50):\n        x_t = torch.randn(32, 128)\n        h = gru_cell(x_t, h)\n    \n    print(f\"æœ€ç»ˆéšè—çŠ¶æ€å½¢çŠ¶: {h.shape}\")"
        }
      ]
    }
  ]
}