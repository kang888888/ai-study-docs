{
  "title": "çº¿æ€§åˆå¹¶ï¼ˆLinear Mergeï¼‰",
  "subtitle": "é€šè¿‡ç®€å•çš„åŠ æƒå¹³å‡å°†å¤šä¸ªæ¨¡å‹çš„å‚æ•°åˆå¹¶ï¼Œæ˜¯æœ€åŸºç¡€ä¸”å¹¿æ³›ä½¿ç”¨çš„æ¨¡å‹åˆå¹¶æ–¹æ³•ï¼Œé€‚åˆç›¸ä¼¼æ¶æ„çš„æ¨¡å‹ã€‚",
  "content": [
    {
      "type": "section",
      "title": "ğŸ“– æ ¸å¿ƒæ¦‚å¿µ",
      "content": [
        {
          "type": "desc-box",
          "content": [
            "çº¿æ€§åˆå¹¶æ˜¯æœ€ç®€å•ç›´æ¥çš„æ¨¡å‹åˆå¹¶æ–¹æ³•ï¼Œé€šè¿‡å¯¹å¤šä¸ªæ¨¡å‹çš„å‚æ•°è¿›è¡ŒåŠ æƒå¹³å‡æ¥å®ç°åˆå¹¶ã€‚è¿™ç§æ–¹æ³•è®¡ç®—ç®€å•ã€é€Ÿåº¦å¿«ï¼Œé€‚åˆåˆå¹¶å…·æœ‰ç›¸ä¼¼æ¶æ„å’Œè®­ç»ƒç›®æ ‡çš„æ¨¡å‹ã€‚çº¿æ€§åˆå¹¶ä¸éœ€è¦é¢å¤–çš„è®­ç»ƒæ•°æ®ï¼Œå¯ä»¥åœ¨CPUä¸Šå¿«é€Ÿå®Œæˆã€‚"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“Š æ¶æ„å›¾è§£",
      "content": [
        {
          "type": "diagram-gallery",
          "images": [
            {
              "type": "svg-d3",
              "component": "GenericDiagram",
              "caption": "çº¿æ€§åˆå¹¶æµç¨‹",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "flow",
                "title": "çº¿æ€§åˆå¹¶æµç¨‹",
                "data": null
              }
            },
            {
              "type": "svg-d3",
              "component": "GenericDiagram",
              "caption": "æƒé‡åˆ†é…",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "æƒé‡åˆ†é…",
                "data": null
              }
            },
            {
              "type": "svg-d3",
              "component": "GenericDiagram",
              "caption": "åˆå¹¶æ•ˆæœå¯¹æ¯”",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "comparison",
                "title": "åˆå¹¶æ•ˆæœå¯¹æ¯”",
                "data": null
              }
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸŒŸ æ ¸å¿ƒç‰¹ç‚¹",
      "content": [
        {
          "type": "features",
          "items": [
            "è®¡ç®—ç®€å•ï¼šåªéœ€å¯¹å‚æ•°è¿›è¡ŒåŠ æƒå¹³å‡ï¼Œè®¡ç®—å¤æ‚åº¦ä½",
            "é€Ÿåº¦å¿«ï¼šæ— éœ€GPUï¼Œåœ¨CPUä¸Šå³å¯å¿«é€Ÿå®Œæˆåˆå¹¶",
            "é€‚ç”¨æ€§å¹¿ï¼šé€‚åˆåˆå¹¶ç›¸ä¼¼æ¶æ„å’Œè®­ç»ƒç›®æ ‡çš„æ¨¡å‹",
            "æ— éœ€æ•°æ®ï¼šä¸éœ€è¦é¢å¤–çš„è®­ç»ƒæ•°æ®æˆ–éªŒè¯é›†",
            "æƒé‡å¯è°ƒï¼šå¯ä»¥çµæ´»è°ƒæ•´å„æ¨¡å‹çš„æƒé‡æ¯”ä¾‹",
            "ä¿æŒæ€§èƒ½ï¼šåˆå¹¶åçš„æ¨¡å‹é€šå¸¸èƒ½ä¿æŒåŸå§‹æ¨¡å‹çš„å¹³å‡æ€§èƒ½"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“ æ•°å­¦åŸç†",
      "content": [
        {
          "type": "math-box",
          "title": "çº¿æ€§åˆå¹¶å…¬å¼",
          "formulas": [
            {
              "display": "\\theta_{merged} = \\sum_{i=1}^{n} w_i \\theta_i"
            },
            {
              "text": "å…¶ä¸­ $\\theta_i$ æ˜¯ç¬¬ $i$ ä¸ªæ¨¡å‹çš„å‚æ•°ï¼Œ$w_i$ æ˜¯ç¬¬ $i$ ä¸ªæ¨¡å‹çš„æƒé‡ï¼Œé€šå¸¸æ»¡è¶³ $\\sum_{i=1}^{n} w_i = 1$ã€‚",
              "inline": "w_i"
            }
          ]
        },
        {
          "type": "math-box",
          "title": "é€å±‚åˆå¹¶",
          "formulas": [
            {
              "display": "\\theta_{merged}^{(l)} = \\sum_{i=1}^{n} w_i \\theta_i^{(l)}"
            },
            {
              "text": "å¯¹æ¯ä¸€å±‚ $l$ çš„å‚æ•°åˆ†åˆ«è¿›è¡ŒåŠ æƒå¹³å‡ï¼Œå¯ä»¥é’ˆå¯¹ä¸åŒå±‚ä½¿ç”¨ä¸åŒçš„æƒé‡ç­–ç•¥ã€‚",
              "inline": "l"
            }
          ]
        },
        {
          "type": "math-box",
          "title": "æƒé‡é€‰æ‹©",
          "formulas": [
            {
              "text": "å¸¸è§æƒé‡åˆ†é…ç­–ç•¥ï¼š"
            },
            {
              "display": "w_i = \\frac{1}{n} \\quad \\text{ï¼ˆå‡åŒ€æƒé‡ï¼‰}"
            },
            {
              "display": "w_i = \\frac{\\text{æ€§èƒ½}_i}{\\sum_{j=1}^{n} \\text{æ€§èƒ½}_j} \\quad \\text{ï¼ˆæ€§èƒ½åŠ æƒï¼‰}"
            },
            {
              "text": "å¯ä»¥æ ¹æ®å„æ¨¡å‹çš„æ€§èƒ½æˆ–é‡è¦æ€§æ¥åˆ†é…æƒé‡ã€‚"
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ’» Python ä»£ç ç¤ºä¾‹",
      "content": [
        {
          "type": "code-box",
          "title": "åŸºç¡€çº¿æ€§åˆå¹¶å®ç°",
          "language": "python",
          "code": "import torch\nfrom transformers import AutoModelForCausalLM\n\n# åŠ è½½å¤šä¸ªæ¨¡å‹\nmodel1 = AutoModelForCausalLM.from_pretrained(\"model1-path\")\nmodel2 = AutoModelForCausalLM.from_pretrained(\"model2-path\")\nmodel3 = AutoModelForCausalLM.from_pretrained(\"model3-path\")\n\n# å®šä¹‰æƒé‡ï¼ˆæ€»å’Œåº”ä¸º1ï¼‰\nweights = [0.4, 0.4, 0.2]  # æ¨¡å‹1ã€2ã€3çš„æƒé‡\n\n# æ‰§è¡Œçº¿æ€§åˆå¹¶\nmerged_state_dict = {}\nfor key in model1.state_dict():\n    merged_state_dict[key] = (\n        weights[0] * model1.state_dict()[key] +\n        weights[1] * model2.state_dict()[key] +\n        weights[2] * model3.state_dict()[key]\n    )\n\n# åˆ›å»ºåˆå¹¶åçš„æ¨¡å‹\nmerged_model = AutoModelForCausalLM.from_pretrained(\"model1-path\")\nmerged_model.load_state_dict(merged_state_dict)\nmerged_model.save_pretrained(\"./merged_model\")"
        },
        {
          "type": "code-box",
          "title": "ä½¿ç”¨MergeKitè¿›è¡Œçº¿æ€§åˆå¹¶",
          "language": "python",
          "code": "from mergekit import MergeKit\n\n# é…ç½®åˆå¹¶å‚æ•°\nmerge_config = {\n    \"models\": [\n        {\n            \"model\": \"microsoft/DialoGPT-medium\",\n            \"weight\": 0.5\n        },\n        {\n            \"model\": \"microsoft/DialoGPT-large\", \n            \"weight\": 0.5\n        }\n    ],\n    \"merge_method\": \"linear\",\n    \"output_path\": \"./merged_model\"\n}\n\n# æ‰§è¡Œåˆå¹¶\nmerger = MergeKit()\nmerged_model = merger.merge(merge_config)\nprint(\"æ¨¡å‹åˆå¹¶å®Œæˆï¼\")"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸš€ åº”ç”¨åœºæ™¯",
      "content": [
        {
          "type": "app-box",
          "content": "å¤šæ¨¡å‹é›†æˆï¼šå°†å¤šä¸ªè®­ç»ƒå¥½çš„æ¨¡å‹åˆå¹¶ï¼Œè·å¾—æ›´ç¨³å®šçš„æ€§èƒ½ã€‚æ¨¡å‹å¹³å‡ï¼šé€šè¿‡å¹³å‡å¤šä¸ªæ£€æŸ¥ç‚¹æˆ–ä¸åŒéšæœºåˆå§‹åŒ–çš„æ¨¡å‹æ¥æå‡æ³›åŒ–èƒ½åŠ›ã€‚çŸ¥è¯†èåˆï¼šåˆå¹¶åœ¨ä¸åŒæ•°æ®é›†ä¸Šè®­ç»ƒçš„æ¨¡å‹ï¼Œèåˆä¸åŒé¢†åŸŸçš„çŸ¥è¯†ã€‚å¿«é€Ÿå®éªŒï¼šæ— éœ€é‡æ–°è®­ç»ƒï¼Œå¿«é€Ÿå°è¯•ä¸åŒæ¨¡å‹çš„ç»„åˆã€‚"
        }
      ]
    },
    {
      "type": "section",
      "title": "âš ï¸ æ³¨æ„äº‹é¡¹",
      "content": [
        {
          "type": "features",
          "items": [
            "æ¶æ„å…¼å®¹æ€§ï¼šåˆå¹¶çš„æ¨¡å‹å¿…é¡»å…·æœ‰ç›¸åŒçš„æ¶æ„æˆ–å…¼å®¹çš„æ¶æ„",
            "æƒé‡é€‰æ‹©ï¼šéœ€è¦ä»”ç»†é€‰æ‹©æƒé‡ï¼Œä¸åŒæƒé‡å¯èƒ½å¯¼è‡´æ€§èƒ½å·®å¼‚",
            "æ€§èƒ½æƒè¡¡ï¼šåˆå¹¶åçš„æ¨¡å‹æ€§èƒ½é€šå¸¸ä»‹äºå„æ¨¡å‹ä¹‹é—´ï¼Œå¯èƒ½ä¸ä¼šè¶…è¿‡æœ€ä½³æ¨¡å‹",
            "å‚æ•°å¯¹é½ï¼šç¡®ä¿å„æ¨¡å‹çš„å‚æ•°åç§°å’Œå½¢çŠ¶å®Œå…¨ä¸€è‡´",
            "éªŒè¯æµ‹è¯•ï¼šåˆå¹¶åéœ€è¦è¿›è¡Œå……åˆ†çš„éªŒè¯æµ‹è¯•ï¼Œç¡®ä¿æ€§èƒ½ç¬¦åˆé¢„æœŸ"
          ]
        }
      ]
    }
  ]
}
