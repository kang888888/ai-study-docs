{
  "title": "ä»»åŠ¡å‘é‡åˆå¹¶ï¼ˆTask Vector Mergeï¼‰",
  "subtitle": "é€šè¿‡æå–ä»»åŠ¡å‘é‡ï¼ˆå¾®è°ƒæ¨¡å‹ä¸åŸºç¡€æ¨¡å‹çš„å·®å¼‚ï¼‰æ¥åˆå¹¶å¤šä¸ªä»»åŠ¡ç‰¹åŒ–æ¨¡å‹ï¼Œå®ç°å¤šä»»åŠ¡èƒ½åŠ›èåˆã€‚",
  "content": [
    {
      "type": "section",
      "title": "ğŸ“– æ ¸å¿ƒæ¦‚å¿µ",
      "content": [
        {
          "type": "desc-box",
          "content": [
            "ä»»åŠ¡å‘é‡åˆå¹¶æ˜¯ä¸€ç§åŸºäºä»»åŠ¡å‘é‡çš„æ¨¡å‹åˆå¹¶æ–¹æ³•ã€‚ä»»åŠ¡å‘é‡è¡¨ç¤ºå¾®è°ƒæ¨¡å‹ä¸åŸºç¡€æ¨¡å‹ä¹‹é—´çš„å·®å¼‚ï¼Œé€šè¿‡åˆå¹¶å¤šä¸ªä»»åŠ¡å‘é‡ï¼Œå¯ä»¥åœ¨ä¿æŒåŸºç¡€æ¨¡å‹èƒ½åŠ›çš„åŒæ—¶ï¼Œèåˆå¤šä¸ªä»»åŠ¡çš„ç‰¹åŒ–èƒ½åŠ›ã€‚è¿™ç§æ–¹æ³•ç‰¹åˆ«é€‚åˆéœ€è¦å¤šä»»åŠ¡èƒ½åŠ›çš„åœºæ™¯ã€‚"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“Š æ¶æ„å›¾è§£",
      "content": [
        {
          "type": "diagram-gallery",
          "images": [
            {
              "type": "svg-d3",
              "component": "GenericDiagram",
              "caption": "ä»»åŠ¡å‘é‡æå–",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "flow",
                "title": "ä»»åŠ¡å‘é‡æå–"
              }
            },
            {
              "type": "svg-d3",
              "component": "GenericDiagram",
              "caption": "ä»»åŠ¡å‘é‡åˆå¹¶",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "architecture",
                "title": "ä»»åŠ¡å‘é‡åˆå¹¶"
              }
            },
            {
              "type": "svg-d3",
              "component": "GenericDiagram",
              "caption": "å¤šä»»åŠ¡èƒ½åŠ›èåˆ",
              "width": 1000,
              "height": 800,
              "interactive": true,
              "props": {
                "type": "comparison",
                "title": "å¤šä»»åŠ¡èƒ½åŠ›èåˆ"
              }
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸŒŸ æ ¸å¿ƒç‰¹ç‚¹",
      "content": [
        {
          "type": "features",
          "items": [
            "ä»»åŠ¡ç‰¹åŒ–ï¼šèƒ½å¤Ÿèåˆå¤šä¸ªä»»åŠ¡çš„ç‰¹åŒ–èƒ½åŠ›",
            "ä¿æŒåŸºç¡€èƒ½åŠ›ï¼šåˆå¹¶åä»ä¿æŒåŸºç¡€æ¨¡å‹çš„é€šç”¨èƒ½åŠ›",
            "çµæ´»ç»„åˆï¼šå¯ä»¥çµæ´»è°ƒæ•´ä¸åŒä»»åŠ¡å‘é‡çš„æƒé‡",
            "å‡å°‘å¹²æ‰°ï¼šé€šè¿‡ä»»åŠ¡å‘é‡å‡å°‘ä¸åŒä»»åŠ¡ä¹‹é—´çš„å¹²æ‰°",
            "å¯è§£é‡Šæ€§ï¼šä»»åŠ¡å‘é‡ç›´è§‚åœ°è¡¨ç¤ºä»»åŠ¡ç‰¹å®šçš„å˜åŒ–",
            "å¤šä»»åŠ¡å­¦ä¹ ï¼šé€‚åˆéœ€è¦åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡çš„åœºæ™¯"
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ“ æ•°å­¦åŸç†",
      "content": [
        {
          "type": "math-box",
          "title": "ä»»åŠ¡å‘é‡å®šä¹‰",
          "formulas": [
            {
              "display": "\\tau_i = \\theta_{fine-tuned}^{(i)} - \\theta_{base}"
            },
            {
              "text": "ä»»åŠ¡å‘é‡ $\\tau_i$ è¡¨ç¤ºç¬¬ $i$ ä¸ªä»»åŠ¡çš„å¾®è°ƒæ¨¡å‹ä¸åŸºç¡€æ¨¡å‹çš„å‚æ•°å·®å¼‚ã€‚",
              "inline": "\\tau_i"
            }
          ]
        },
        {
          "type": "math-box",
          "title": "ä»»åŠ¡å‘é‡åˆå¹¶",
          "formulas": [
            {
              "display": "\\theta_{merged} = \\theta_{base} + \\sum_{i=1}^{n} \\alpha_i \\tau_i"
            },
            {
              "text": "å…¶ä¸­ $\\alpha_i$ æ§åˆ¶ç¬¬ $i$ ä¸ªä»»åŠ¡å‘é‡çš„è´¡çŒ®ï¼Œå¯ä»¥è°ƒæ•´ä¸åŒä»»åŠ¡çš„é‡è¦æ€§ã€‚",
              "inline": "\\alpha_i"
            }
          ]
        },
        {
          "type": "math-box",
          "title": "æƒé‡å½’ä¸€åŒ–",
          "formulas": [
            {
              "display": "\\sum_{i=1}^{n} |\\alpha_i| \\leq 1"
            },
            {
              "text": "ä¸ºäº†ä¿æŒæ¨¡å‹ç¨³å®šæ€§ï¼Œé€šå¸¸é™åˆ¶ä»»åŠ¡å‘é‡æƒé‡çš„æ€»å’Œä¸è¶…è¿‡1ã€‚",
              "inline": "\\alpha_i"
            }
          ]
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸ’» Python ä»£ç ç¤ºä¾‹",
      "content": [
        {
          "type": "code-box",
          "title": "ä»»åŠ¡å‘é‡æå–ä¸åˆå¹¶",
          "language": "python",
          "code": "import torch\nfrom transformers import AutoModelForCausalLM\n\n# åŠ è½½åŸºç¡€æ¨¡å‹å’Œå¾®è°ƒæ¨¡å‹\nbase_model = AutoModelForCausalLM.from_pretrained(\"base-model-path\")\nft_model_1 = AutoModelForCausalLM.from_pretrained(\"fine-tuned-model-1-path\")\nft_model_2 = AutoModelForCausalLM.from_pretrained(\"fine-tuned-model-2-path\")\n\n# è®¡ç®—ä»»åŠ¡å‘é‡\ntask_vector_1 = {}\ntask_vector_2 = {}\nfor key in base_model.state_dict():\n    task_vector_1[key] = ft_model_1.state_dict()[key] - base_model.state_dict()[key]\n    task_vector_2[key] = ft_model_2.state_dict()[key] - base_model.state_dict()[key]\n\n# åˆå¹¶ä»»åŠ¡å‘é‡ï¼ˆè®¾ç½®æƒé‡ï¼‰\nalphas = [0.4, 0.3]  # ä»»åŠ¡1å’Œä»»åŠ¡2çš„æƒé‡\nmerged_params = base_model.state_dict().copy()\n\nfor key in merged_params:\n    merged_params[key] = base_model.state_dict()[key]\n    merged_params[key] += alphas[0] * task_vector_1[key]\n    merged_params[key] += alphas[1] * task_vector_2[key]\n\n# åˆ›å»ºåˆå¹¶åçš„æ¨¡å‹\nmerged_model = AutoModelForCausalLM.from_pretrained(\"base-model-path\")\nmerged_model.load_state_dict(merged_params)\nmerged_model.save_pretrained(\"./merged_model\")"
        },
        {
          "type": "code-box",
          "title": "ä½¿ç”¨MergeKitè¿›è¡Œä»»åŠ¡å‘é‡åˆå¹¶",
          "language": "python",
          "code": "from mergekit import MergeKit\n\n# é…ç½®ä»»åŠ¡å‘é‡åˆå¹¶\nmerge_config = {\n    \"base_model\": \"base-model-path\",\n    \"task_vectors\": [\n        {\n            \"model\": \"fine-tuned-model-1-path\",\n            \"alpha\": 0.4\n        },\n        {\n            \"model\": \"fine-tuned-model-2-path\",\n            \"alpha\": 0.3\n        }\n    ],\n    \"merge_method\": \"task_vector\",\n    \"output_path\": \"./merged_model\"\n}\n\n# æ‰§è¡Œåˆå¹¶\nmerger = MergeKit()\nmerged_model = merger.merge(merge_config)\nprint(\"ä»»åŠ¡å‘é‡åˆå¹¶å®Œæˆï¼\")"
        }
      ]
    },
    {
      "type": "section",
      "title": "âš™ï¸ å…³é”®æŠ€æœ¯",
      "content": [
        {
          "type": "tech-box",
          "content": "ä»»åŠ¡å‘é‡æå–ã€å‘é‡åˆå¹¶ã€å‚æ•°å·®å¼‚ã€å¤šä»»åŠ¡èåˆã€alphaç¼©æ”¾"
        }
      ]
    },
    {
      "type": "section",
      "title": "ğŸš€ åº”ç”¨åœºæ™¯",
      "content": [
        {
          "type": "app-box",
          "content": "å¤šä»»åŠ¡å­¦ä¹ ï¼šåˆå¹¶å¤šä¸ªä»»åŠ¡ç‰¹åŒ–æ¨¡å‹ï¼Œåˆ›å»ºä¸€ä¸ªèƒ½åŒæ—¶å¤„ç†å¤šé¡¹ä»»åŠ¡çš„ç»Ÿä¸€æ¨¡å‹ã€‚é¢†åŸŸé€‚åº”ï¼šèåˆä¸åŒé¢†åŸŸçš„ç‰¹åŒ–æ¨¡å‹ï¼Œå®ç°è·¨é¢†åŸŸèƒ½åŠ›ã€‚æŠ€èƒ½ç»„åˆï¼šå°†ä¸åŒæŠ€èƒ½ï¼ˆå¦‚ä»£ç ç”Ÿæˆã€æ•°å­¦æ¨ç†ï¼‰çš„æ¨¡å‹åˆå¹¶ï¼Œåˆ›å»ºå¤šæŠ€èƒ½æ¨¡å‹ã€‚å¿«é€Ÿè¿­ä»£ï¼šæ— éœ€é‡æ–°è®­ç»ƒï¼Œå¿«é€Ÿå°è¯•ä¸åŒä»»åŠ¡ç»„åˆã€‚"
        }
      ]
    },
    {
      "type": "section",
      "title": "âš ï¸ æ³¨æ„äº‹é¡¹",
      "content": [
        {
          "type": "features",
          "items": [
            "åŸºç¡€æ¨¡å‹ä¸€è‡´æ€§ï¼šæ‰€æœ‰ä»»åŠ¡å‘é‡å¿…é¡»åŸºäºåŒä¸€ä¸ªåŸºç¡€æ¨¡å‹",
            "ä»»åŠ¡å¹²æ‰°ï¼šä¸åŒä»»åŠ¡ä¹‹é—´å¯èƒ½å­˜åœ¨å¹²æ‰°ï¼Œéœ€è¦ä»”ç»†è°ƒæ•´æƒé‡",
            "æƒé‡é€‰æ‹©ï¼šæƒé‡è¿‡å¤§å¯èƒ½å¯¼è‡´æ¨¡å‹ä¸ç¨³å®šï¼Œéœ€è¦å®éªŒç¡®å®šæœ€ä½³å€¼",
            "ä»»åŠ¡ç›¸å…³æ€§ï¼šç›¸å…³ä»»åŠ¡æ›´å®¹æ˜“æˆåŠŸåˆå¹¶ï¼Œä¸ç›¸å…³ä»»åŠ¡å¯èƒ½äº§ç”Ÿå†²çª",
            "éªŒè¯æµ‹è¯•ï¼šåˆå¹¶åéœ€è¦åœ¨å„ä»»åŠ¡ä¸Šè¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿æ€§èƒ½ä¸ä¸‹é™"
          ]
        }
      ]
    }
  ]
}